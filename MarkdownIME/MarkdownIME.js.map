{"version":3,"sources":["webpack://MarkdownIME/webpack/universalModuleDefinition","webpack://MarkdownIME/webpack/bootstrap","webpack://MarkdownIME/./src/dom/index.ts","webpack://MarkdownIME/./src/transformer/pattern/block.ts","webpack://MarkdownIME/./src/transformer/hr.ts","webpack://MarkdownIME/./src/transformer/header.ts","webpack://MarkdownIME/./src/transformer/blockquote.ts","webpack://MarkdownIME/./src/transformer/ordered-list.ts","webpack://MarkdownIME/./src/transformer/unordered-list.ts","webpack://MarkdownIME/./src/transformer/codefence.ts","webpack://MarkdownIME/./src/dom/textNodeSearch.ts","webpack://MarkdownIME/./src/transformer/pattern/inline.ts","webpack://MarkdownIME/./src/transformer/index.ts","webpack://MarkdownIME/./src/transformer/inline-collection.ts","webpack://MarkdownIME/./src/transformer/link-n-image.ts","webpack://MarkdownIME/./src/transformer/emoji.ts","webpack://MarkdownIME/./src/extra/emoji-data.ts","webpack://MarkdownIME/./src/transformer/math.ts","webpack://MarkdownIME/./src/extra/shortkeys.ts","webpack://MarkdownIME/./src/extra/table-keys.ts","webpack://MarkdownIME/./src/extra/leave-block.ts","webpack://MarkdownIME/./src/extra/toast.ts","webpack://MarkdownIME/./src/index.ts","webpack://MarkdownIME/./src/extra/new-line.ts","webpack://MarkdownIME/./src/extra/make-table.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","win","dom_document","document","setContextDocument","doc","defaultView","getContextDocument","findCaret","sel","getSelection","anchorNode","anchorOffset","isCollapsed","nodeType","Node","ELEMENT_NODE","childNodes","TEXT_NODE","textContent","previousSibling","length","slice","newNode","createTextNode","parentNode","insertBefore","nextSibling","setPosition","setCaret","anchor","offset","collapseToEnd","scrollIntoViewIfNeeded","isTextNode","setCaretAfter","parent","indexOf","getLineContainer","el","findUpward","node","test","nodeName","breakElement","parentElement","frag","createDocumentFragment","appendChild","removeChild","checker","tidy","nodes","base","forwardCnt","forwardText","elt","tag","attrs","content","createElement","attr","val","setAttribute","forEach","child","makeBr","data-bogus","makeLine","replace","old","insertAfter","refNode","getViewport","_window","considerScroll","left","pageXOffset","top","pageYOffset","height","innerHeight","width","innerWidth","right","bottom","rectContains","container","subRect","body","ownerDocument","scrollArg","nodeRect","getBoundingClientRect","node_it","rectRelation","scrollIntoView","createBlockTransformer","prefix","transformLine","caret","matchResult","match","line","tmpNode","placeHolder","createComment","newLine","err","querySelector","br","transformer_hr","hr","header","blockquote","bqCount","txt","charAt","isInList","tagName","toLowerCase","ans","ordered_list","start","unordered_list","codefence","lang","lastIndexOf","needle","since","ch","createInlineTransformer","doWrap","reserveTag","tagLen","caretIsSafeForInline","caretTextLen","beginPos","endCh","bnt","range","createRange","setStart","setEnd","wrapper","makeWrapFn","surroundContents","wrapCode","wrapBold","wrapItalic","wrapDel","wrapBoldItalic","wrapperOutside","inline_collection","link_n_image","lineNodes","endPos","middlePos","urlRange","url","cloneContents","trim","resultElement","isImage","textRange","src","alt","deleteContents","insertNode","href","junkRange","shortcodeDict","smile","emoticonDict",":)","dest","parts","matRE","lastIndex","exec","loadShortCodes","sc","angry","blush","broken_heart","confused","cry","frowning","heart","two_hearts","imp","innocent","joy","kissing","laughing","neutral","open_mouth","rage","smiley","smiling_imp","sob","tongue","sunglasses","sweat","unamused","wink","_loop_1","shortcode","emoji","emoticon","loadEmoticons","renderer","defaultRenderer","getMathRenderer","setMathRenderer","formula","displayMode","encodeURIComponent","title","data-formula","transformers","concat","text","output","removeCharCount","mat","expr","mathEl","bindShortkeys","editor","addEventListener","ev","ctrl","ctrlKey","shift","shiftKey","altKey","which","execCommand","handleFormattingKeys","focusNode","focusOffset","getRangeAt","code","newCaretAfter","lastChild","toggleInlineElement","keyCode","noAdditionalKeys","selection","td","tr","table","td_index","td_count","childElementCount","children","focus","removeRow","nextElementSibling","firstElementChild","insertRow","focusCell","newTr","previousElementSibling","trs","querySelectorAll","tr_1","refTd","removeColumn","tr_2","newTd","insertColumn","lastElementChild","preventDefault","handleKeyboardEvent","stopPropagation","ToastStatus","leave_block","pre","oldWrapper","newWrapper","Toast","this","status","Hidden","ele","style","dismiss","element","topOrBottom","isBottom","show","timeout","_this","setTimeout","Shown","opacity","marginTop","Hiding","showToast","ref","cover","rect","toast","x","scrollLeft","y","scrollTop","SHORT","LONG","Scan","candidates","editors","candidate","push","result","contentWindow","apply","Enhance","options","EnhanceOne","Bookmarklet","opts","successToast","noShortkey","id","className","doTransform","enterKey","caretEl","placeholder","trResult","transformer","isInCodeFence","success","navigator","userAgent","cNext","tryInsertLine","first","last","headerCells","currentCell","goNextCell","srcNode","split","idx","headerRow","contentRow","map","contentCell","tryMakeTable","__webpack_exports__","dom_namespaceObject"],"mappings":"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","file":"MarkdownIME.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MarkdownIME\"] = factory();\n\telse\n\t\troot[\"MarkdownIME\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/** This file provides some util functions for DOM manipulation */\r\nvar win = window;\r\nvar document = window.document;\r\n/** Set the context document. This will affect some DOM operation like `elt`, `findCaret` */\r\nexport function setContextDocument(doc) {\r\n    document = doc || window.document;\r\n    win = document.defaultView;\r\n}\r\n/**\r\n * Get the context document that currently MarkdownIME is using.\r\n *\r\n * The context affects some DOM operation like `elt`, `findCaret`\r\n */\r\nexport function getContextDocument() {\r\n    return document;\r\n}\r\n/**\r\n * Try to get the node which is exactly before the caret.\r\n */\r\nexport function findCaret() {\r\n    var sel = document.getSelection();\r\n    var anchorNode = sel.anchorNode, anchorOffset = sel.anchorOffset;\r\n    if (!sel.isCollapsed || !anchorNode)\r\n        return null;\r\n    if (anchorNode.nodeType === Node.ELEMENT_NODE) {\r\n        return anchorOffset == 0 ? anchorNode : anchorNode.childNodes[anchorOffset - 1];\r\n    }\r\n    if (anchorNode.nodeType === Node.TEXT_NODE) {\r\n        var textContent = anchorNode.textContent;\r\n        if (anchorOffset == 0)\r\n            return anchorNode.previousSibling;\r\n        if (textContent.length <= anchorOffset)\r\n            return anchorNode;\r\n        // break text node into two\r\n        anchorNode.textContent = textContent.slice(0, anchorOffset);\r\n        var newNode = document.createTextNode(textContent.slice(anchorOffset));\r\n        anchorNode.parentNode.insertBefore(newNode, anchorNode.nextSibling);\r\n        sel.setPosition(anchorNode, anchorOffset);\r\n        return anchorNode;\r\n    }\r\n    return null;\r\n}\r\nexport function setCaret(anchor, offset) {\r\n    var sel = document.getSelection();\r\n    if (!sel.isCollapsed)\r\n        sel.collapseToEnd();\r\n    sel.setPosition(anchor, offset || 0);\r\n    scrollIntoViewIfNeeded((isTextNode(anchor) ? anchor.parentNode : anchor));\r\n}\r\nexport function setCaretAfter(anchor) {\r\n    var parent = anchor.parentNode;\r\n    setCaret(parent, [].indexOf.call(parent.childNodes, anchor) + 1);\r\n    scrollIntoViewIfNeeded((isTextNode(anchor) ? parent : anchor));\r\n}\r\n/**\r\n * Get Line Container Node\r\n */\r\nexport function getLineContainer(el) {\r\n    return findUpward(el, function (node) { return /^(?:div|p|h\\d|pre|body|td|th|li|dt|dd|blockquote)$/i.test(node.nodeName); });\r\n}\r\nexport function breakElement(el) {\r\n    if (!el || !el.parentElement)\r\n        return;\r\n    var parent = el.parentElement;\r\n    var frag = document.createDocumentFragment();\r\n    while (el.childNodes.length)\r\n        frag.appendChild(el.childNodes[0]);\r\n    parent.insertBefore(frag, el);\r\n    parent.removeChild(el);\r\n}\r\nexport function findUpward(el, checker) {\r\n    while (el) {\r\n        if (checker(el))\r\n            return el;\r\n        else\r\n            el = el.parentNode;\r\n    }\r\n    return null;\r\n}\r\n/** tidy one node's childNodes, concate broken text nodes */\r\nexport function tidy(el) {\r\n    var nodes = el.childNodes;\r\n    for (var i = 0; i < nodes.length; i++) {\r\n        var base = nodes[i];\r\n        if (base.nodeType !== Node.TEXT_NODE)\r\n            continue;\r\n        var forwardCnt = 1;\r\n        var forwardText = \"\";\r\n        while (nodes[i + forwardCnt] && nodes[i + forwardCnt].nodeType === Node.TEXT_NODE) {\r\n            forwardText += nodes[i + forwardCnt].textContent;\r\n            forwardCnt++;\r\n        }\r\n        if (forwardCnt > 1) {\r\n            while (forwardCnt-- > 1)\r\n                el.removeChild(nodes[i + 1]);\r\n            base.textContent += forwardText;\r\n        }\r\n        i++;\r\n    }\r\n}\r\nexport function elt(tag, attrs, content) {\r\n    var el = document.createElement(tag);\r\n    if (attrs)\r\n        for (var attr in attrs) {\r\n            var val = attrs[attr];\r\n            el.setAttribute(attr, \"\" + val);\r\n        }\r\n    if (typeof content === 'string')\r\n        el.textContent = content;\r\n    else if (content && content.length > 0)\r\n        [].slice.call(content).forEach(function (child) { return el.appendChild(child); });\r\n    return el;\r\n}\r\n/** create <br> for empty lines */\r\nexport function makeBr() {\r\n    return elt('br', { 'data-bogus': true });\r\n}\r\n/** create <p> for empty lines */\r\nexport function makeLine(content) {\r\n    return elt('p', null, content || [makeBr()]);\r\n}\r\n/** insert new node before old one, then remove old one */\r\nexport function replace(old, newNode) {\r\n    var parent = old && old.parentNode;\r\n    if (!parent)\r\n        return;\r\n    parent.insertBefore(newNode, old);\r\n    parent.removeChild(old);\r\n}\r\n/** insert a node after an existsing one */\r\nexport function insertAfter(newNode, refNode) {\r\n    var parent = refNode && refNode.parentNode;\r\n    if (!parent)\r\n        return;\r\n    parent.insertBefore(newNode, refNode.nextSibling);\r\n}\r\nexport function isTextNode(node) {\r\n    return node && node.nodeType === Node.TEXT_NODE;\r\n}\r\n/**\r\n * get current viewport rect\r\n *\r\n * @returns Non-Standard ClientRect (because IE/Edge not supports DOMRect)\r\n */\r\nexport function getViewport(_window, considerScroll) {\r\n    if (!_window)\r\n        _window = win || window;\r\n    var left = considerScroll ? _window.pageXOffset : 0;\r\n    var top = considerScroll ? _window.pageYOffset : 0;\r\n    var height = _window.innerHeight;\r\n    var width = _window.innerWidth;\r\n    return {\r\n        left: left, top: top, height: height, width: width,\r\n        right: left + width,\r\n        bottom: top + height,\r\n    };\r\n}\r\nfunction rectContains(container, subRect) {\r\n    if (container.left >= subRect.left)\r\n        return 3 /* LEFT */;\r\n    if (container.right <= subRect.right)\r\n        return 4 /* RIGHT */;\r\n    if (container.top >= subRect.top)\r\n        return 1 /* ABOVE */;\r\n    if (container.bottom <= subRect.bottom)\r\n        return 2 /* BELOW */;\r\n    return 0 /* CONTAINED */;\r\n}\r\n/**\r\n * a much better polyfill for scrollIntoViewIfNeeded\r\n *\r\n * @returns - `true` -- trigged and now node is on the top edge.\r\n *          - `false` -- trigged and node is on the bottom edge.\r\n *          - `undefined` -- nothing happened\r\n */\r\nexport function scrollIntoViewIfNeeded(node) {\r\n    if ('scrollIntoViewIfNeeded' in node) { // Chrome only stuff\r\n        node.scrollIntoViewIfNeeded(false);\r\n        return;\r\n    }\r\n    var body = node.ownerDocument.body;\r\n    var window = body.ownerDocument.defaultView;\r\n    var scrollArg = void 0;\r\n    var nodeRect = node.getBoundingClientRect();\r\n    var node_it = node;\r\n    while (scrollArg === void 0) {\r\n        var container = node_it.parentElement;\r\n        var containerRect = (node_it === body) ? getViewport(window, false) : container.getBoundingClientRect();\r\n        var rectRelation = rectContains(containerRect, nodeRect);\r\n        if (rectRelation === 3 /* LEFT */ || rectRelation === 1 /* ABOVE */)\r\n            scrollArg = true;\r\n        if (rectRelation === 4 /* RIGHT */ || rectRelation === 2 /* BELOW */)\r\n            scrollArg = false;\r\n        if (node_it === body)\r\n            break;\r\n        node_it = container;\r\n    }\r\n    if (scrollArg !== void 0)\r\n        node.scrollIntoView(scrollArg);\r\n    return scrollArg;\r\n}\r\n","import { getLineContainer, replace, setCaret, makeBr, getContextDocument } from \"../../dom\";\r\nexport default function createBlockTransformer(prefix, transformLine) {\r\n    return function (caret) {\r\n        var matchResult = caret.textContent.match(prefix);\r\n        if (!matchResult)\r\n            return 0 /* FAILED */;\r\n        var line = getLineContainer(caret);\r\n        var tmpNode = caret;\r\n        while (tmpNode != line) {\r\n            if (tmpNode.previousSibling)\r\n                return 0 /* FAILED */;\r\n            tmpNode = tmpNode.parentNode;\r\n        }\r\n        var document = getContextDocument();\r\n        var placeHolder = document.createComment(\"placeholder\");\r\n        line.parentNode.insertBefore(placeHolder, line);\r\n        var newLine = transformLine(matchResult, line, caret);\r\n        if (!newLine) {\r\n            return 0 /* FAILED */;\r\n        }\r\n        else if (newLine === line) {\r\n            placeHolder.parentNode.removeChild(placeHolder);\r\n        }\r\n        else {\r\n            try {\r\n                placeHolder.parentNode.removeChild(line);\r\n            }\r\n            catch (err) { }\r\n            replace(placeHolder, newLine);\r\n        }\r\n        caret.textContent = \"\";\r\n        if (!newLine.textContent && !newLine.querySelector('br')) {\r\n            var br = makeBr();\r\n            if (caret.nodeType === Node.TEXT_NODE)\r\n                caret.parentNode.insertBefore(br, caret.nextSibling);\r\n            else\r\n                caret.appendChild(br);\r\n        }\r\n        setCaret(caret);\r\n        return 2 /* NEED_PREVENT_DEFAULT */;\r\n    };\r\n}\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformHR = createBlockTransformer(/^---+$/, function (match, line) {\r\n    var hr = elt('hr');\r\n    line.parentNode.insertBefore(hr, line);\r\n    return line;\r\n});\r\nexport default transformHR;\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformHeader = createBlockTransformer(/^#{1,6}$/, function (match, line) {\r\n    var headerLevel = match[0].length;\r\n    var headerEl = elt(\"h\" + headerLevel, null, line.childNodes);\r\n    return headerEl;\r\n});\r\nexport default transformHeader;\r\n","import { elt, makeLine } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformBlockquote = createBlockTransformer(/^(?:>\\s*)+$/, function (match, line) {\r\n    var bqCount = 0, txt = match[0];\r\n    for (var i = 0; i < txt.length; i++)\r\n        if (txt.charAt(i) === '>')\r\n            bqCount++;\r\n    var isInList = line.tagName.toLowerCase() === \"li\";\r\n    if (isInList)\r\n        line = makeLine(line.childNodes);\r\n    var ans = line;\r\n    while (bqCount--)\r\n        ans = elt(\"blockquote\", null, [ans]);\r\n    if (isInList)\r\n        ans = elt(\"li\", null, [ans]);\r\n    return ans;\r\n});\r\nexport default transformBlockquote;\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformOrderedList = createBlockTransformer(/^(\\d+)[\\.\\)]$/, function (match, line) {\r\n    var start = match[1]; // start number\r\n    var item = elt(\"li\", null, line.childNodes);\r\n    var list = elt(\"ol\", { start: start }, [item]);\r\n    return list;\r\n});\r\nexport default transformOrderedList;\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformUnorderedList = createBlockTransformer(/^[-*]$/, function (match, line) {\r\n    var item = elt(\"li\", null, line.childNodes);\r\n    var list = elt(\"ul\", null, [item]);\r\n    return list;\r\n});\r\nexport default transformUnorderedList;\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformCodefence = createBlockTransformer(/^```+([\\w-]*)$/, function (match, line) {\r\n    var lang = match[1];\r\n    var ans = elt('pre', null, line.childNodes);\r\n    if (lang)\r\n        ans.setAttribute(\"data-lang\", lang);\r\n    return ans;\r\n});\r\nexport default transformCodefence;\r\n","export function lastIndexOf(nodes, needle, since) {\r\n    var node, ch;\r\n    if (since) {\r\n        if (!since.node)\r\n            return null;\r\n        node = since.node;\r\n        ch = since.ch;\r\n        while (ch < 0) {\r\n            do {\r\n                node = node.previousSibling;\r\n            } while (node && node.nodeType !== Node.TEXT_NODE);\r\n            if (!node)\r\n                return null;\r\n            node = node;\r\n            ch += node.textContent.length;\r\n        }\r\n        ch = node.textContent.lastIndexOf(needle, ch);\r\n        if (ch > -1)\r\n            return { node: node, ch: ch };\r\n        else\r\n            node = node.previousSibling;\r\n    }\r\n    else {\r\n        node = nodes[nodes.length - 1];\r\n    }\r\n    if (!node)\r\n        return null;\r\n    do {\r\n        if (node.nodeType !== Node.TEXT_NODE)\r\n            continue;\r\n        ch = node.textContent.lastIndexOf(needle);\r\n        if (ch > -1)\r\n            return { node: node, ch: ch };\r\n    } while (node = node.previousSibling);\r\n    return null;\r\n}\r\n","import { setCaretAfter, tidy, getContextDocument } from \"../../dom\";\r\nimport { caretIsSafeForInline } from \"../index\";\r\nimport { lastIndexOf } from \"../../dom/textNodeSearch\";\r\n/**\r\n * Create a Transformer for inline elements.\r\n *\r\n * examples: (where `|` is caret, '**' is tag):\r\n *  - `<p> Hello **World**|</p>`\r\n *  - `<p> Hello **Wo <b>rl</b> d**|</p>`\r\n */\r\nexport default function createInlineTransformer(tag, doWrap, reserveTag) {\r\n    var tagLen = tag.length;\r\n    return function (caret) {\r\n        if (!caretIsSafeForInline(caret) || caret.textContent.slice(-tagLen) !== tag) {\r\n            return 0 /* FAILED */;\r\n        }\r\n        // do not accept **space before tailing tag **\r\n        if (caret.textContent.slice(-tagLen - 1, -tagLen) === ' ')\r\n            return 0 /* FAILED */;\r\n        var document = getContextDocument();\r\n        var caretTextLen = caret.textContent.length;\r\n        // find beginning tag\r\n        var beginPos = lastIndexOf(caret.parentNode.childNodes, tag, { node: caret, ch: caretTextLen - tagLen - 1 });\r\n        if (!beginPos)\r\n            return 0 /* FAILED */;\r\n        var endCh = caretTextLen - tagLen;\r\n        if (!reserveTag) {\r\n            // remove the tag\r\n            caret.textContent = caret.textContent.slice(0, -tagLen);\r\n            var bnt = beginPos.node.textContent;\r\n            beginPos.node.textContent = bnt.slice(0, beginPos.ch) + bnt.slice(beginPos.ch + tagLen);\r\n            if (caret === beginPos.node)\r\n                endCh -= tagLen;\r\n        }\r\n        else {\r\n            // move the selected range\r\n            beginPos.ch += tagLen;\r\n        }\r\n        var range = document.createRange();\r\n        range.setStart(beginPos.node, beginPos.ch);\r\n        range.setEnd(caret, endCh);\r\n        var wrapper = doWrap(range);\r\n        if (!wrapper)\r\n            return 0 /* FAILED */;\r\n        setCaretAfter(wrapper);\r\n        tidy(wrapper.parentElement);\r\n        return 1 /* SUCCESS */;\r\n    };\r\n}\r\n","import { findUpward } from \"../dom\";\r\nimport transformHR from \"./hr\";\r\nimport transformHeader from \"./header\";\r\nimport transformBlockquote from \"./blockquote\";\r\nimport transformOrderedList from \"./ordered-list\";\r\nimport transformUnorderedList from \"./unordered-list\";\r\nimport transformCodefence from \"./codefence\";\r\nimport inlineStyleTransformers from \"./inline-collection\";\r\nimport transformLinkAndImage from \"./link-n-image\";\r\nimport transformEmoji from \"./emoji\";\r\nimport transformMath from \"./math\";\r\nvar transformers = [\r\n    transformHeader, transformHR, transformBlockquote,\r\n    transformOrderedList, transformUnorderedList,\r\n    transformCodefence\r\n].concat(inlineStyleTransformers, [\r\n    transformLinkAndImage,\r\n    transformEmoji,\r\n    transformMath,\r\n]);\r\nexport function caretIsSafeForInline(caret) {\r\n    if (caret.nodeType !== Node.TEXT_NODE)\r\n        return false;\r\n    if (findUpward(caret, function (parent) { return /^(?:code|pre)$/i.test(parent.nodeName); }))\r\n        return false;\r\n    return true;\r\n}\r\nexport { transformers };\r\n","import createInlineTransformer from \"./pattern/inline\";\r\nimport { elt } from \"../dom\";\r\nvar makeWrapFn = function (tag) { return function (range) {\r\n    var wrapper = elt(tag);\r\n    range.surroundContents(wrapper);\r\n    return wrapper;\r\n}; };\r\nexport var wrapCode = makeWrapFn(\"code\");\r\nexport var wrapBold = makeWrapFn(\"b\");\r\nexport var wrapItalic = makeWrapFn(\"i\");\r\nexport var wrapDel = makeWrapFn(\"del\");\r\nexport var wrapBoldItalic = function (range) {\r\n    var wrapper = elt(\"b\");\r\n    var wrapperOutside = elt(\"i\");\r\n    range.surroundContents(wrapper);\r\n    range.surroundContents(wrapperOutside);\r\n    return wrapperOutside;\r\n};\r\nvar inlineStyleTransformers = [\r\n    createInlineTransformer(\"`\", wrapCode),\r\n    createInlineTransformer(\"***\", wrapBoldItalic),\r\n    createInlineTransformer(\"___\", wrapBoldItalic),\r\n    // \"bold\" must be in front of \"italic\"\r\n    createInlineTransformer(\"**\", wrapBold),\r\n    createInlineTransformer(\"__\", wrapBold),\r\n    createInlineTransformer(\"*\", wrapItalic),\r\n    createInlineTransformer(\"_\", wrapItalic),\r\n    createInlineTransformer(\"~~\", wrapDel),\r\n];\r\nexport default inlineStyleTransformers;\r\n","import { setCaretAfter, isTextNode, elt, getContextDocument } from \"../dom\";\r\nimport { lastIndexOf } from \"../dom/textNodeSearch\";\r\nfunction transformLinkAndImage(caret) {\r\n    if (!isTextNode(caret))\r\n        return 0 /* FAILED */;\r\n    if (caret.textContent.slice(-1) !== ')')\r\n        return 0 /* FAILED */;\r\n    var document = getContextDocument();\r\n    var lineNodes = caret.parentElement.childNodes;\r\n    var endPos = { node: caret, ch: caret.textContent.length - 1 };\r\n    var middlePos = lastIndexOf(lineNodes, \"](\", endPos);\r\n    if (!middlePos)\r\n        return 0 /* FAILED */;\r\n    var beginPos = lastIndexOf(lineNodes, \"[\", middlePos);\r\n    if (!beginPos)\r\n        return 0 /* FAILED */;\r\n    // we found ( , )[ and ]    and it's time to extract data\r\n    var urlRange = document.createRange();\r\n    urlRange.setStart(middlePos.node, middlePos.ch);\r\n    urlRange.setEnd(endPos.node, endPos.ch + 1);\r\n    var url = urlRange.cloneContents().textContent.slice(2, -1).trim(); // remove \"](\" and \")\", then trim\r\n    if (!url)\r\n        return 0 /* FAILED */;\r\n    var beginNodeText = beginPos.node.textContent;\r\n    var resultElement;\r\n    var isImage = beginNodeText.charAt(beginPos.ch - 1) === '!';\r\n    var textRange = document.createRange();\r\n    textRange.setStart(beginPos.node, beginPos.ch + 1);\r\n    textRange.setEnd(middlePos.node, middlePos.ch);\r\n    if (isImage) {\r\n        var alt = textRange.cloneContents().textContent.trim();\r\n        resultElement = elt(\"img\", { src: url, alt: alt });\r\n        textRange.setStart(beginPos.node, beginPos.ch - 1);\r\n        textRange.setEnd(endPos.node, endPos.ch + 1);\r\n        textRange.deleteContents();\r\n        textRange.insertNode(resultElement);\r\n    }\r\n    else {\r\n        resultElement = elt(\"a\", { href: url });\r\n        var junkRange = document.createRange();\r\n        junkRange.setStart(beginPos.node, beginPos.ch);\r\n        junkRange.setEnd(beginPos.node, beginPos.ch + 1);\r\n        junkRange.deleteContents();\r\n        urlRange.deleteContents();\r\n        textRange.surroundContents(resultElement);\r\n    }\r\n    setCaretAfter(resultElement);\r\n    return 1 /* SUCCESS */;\r\n}\r\nexport default transformLinkAndImage;\r\n","import { setCaretAfter } from \"../dom\";\r\nimport * as EmojiData from \"../extra/emoji-data\";\r\nexport var shortcodeDict = {\r\n    \"smile\": \"😄\",\r\n};\r\nexport var emoticonDict = {\r\n    \":)\": \"😃\",\r\n};\r\nEmojiData.loadShortCodes(shortcodeDict);\r\nEmojiData.loadEmoticons(emoticonDict, shortcodeDict);\r\nfunction transformEmoji(caret) {\r\n    if (caret.nodeType !== Node.TEXT_NODE)\r\n        return 0 /* FAILED */;\r\n    var text = caret.textContent;\r\n    var output = null;\r\n    var removeCharCount = 0;\r\n    for (var emoticon in emoticonDict) {\r\n        if (text.slice(-emoticon.length) === emoticon) {\r\n            output = emoticonDict[emoticon];\r\n            removeCharCount = emoticon.length;\r\n            break;\r\n        }\r\n    }\r\n    if (!output) {\r\n        var mat = text.match(/:([^:]+):$/);\r\n        output = mat && shortcodeDict[mat[1]];\r\n        if (output) {\r\n            removeCharCount = mat[0].length;\r\n        }\r\n    }\r\n    if (!output)\r\n        return 0 /* FAILED */;\r\n    caret.textContent = text.slice(0, -removeCharCount) + output;\r\n    setCaretAfter(caret);\r\n    return 1 /* SUCCESS */;\r\n}\r\nexport default transformEmoji;\r\n","export function loadEmoticons(dest, shortcodeDict) {\r\n    var sc = {\r\n        angry: ['>:(', '>:-('],\r\n        blush: [':\")', ':-\")'],\r\n        broken_heart: ['</3', '<\\\\3'],\r\n        confused: [':/', ':-/', ':\\\\', ':-\\\\'],\r\n        cry: [\":'(\", \":'-(\", ':,(', ':,-('],\r\n        frowning: [':(', ':-('],\r\n        heart: ['<3'],\r\n        two_hearts: ['<3<3'],\r\n        imp: [']:(', ']:-('],\r\n        innocent: ['o:)', 'O:)', 'o:-)', 'O:-)', '0:)', '0:-)'],\r\n        joy: [\":')\", \":'-)\", ':,)', ':,-)', \":'D\", \":'-D\", ':,D', ':,-D'],\r\n        kissing: [':*', ':-*'],\r\n        laughing: ['x-)', 'X-)'],\r\n        neutral: [':|', ':-|'],\r\n        open_mouth: [':o', ':-o', ':O', ':-O'],\r\n        rage: [':@', ':-@'],\r\n        smile: [':D', ':-D'],\r\n        smiley: [':)', ':-)'],\r\n        smiling_imp: [']:)', ']:-)'],\r\n        sob: [\":,'(\", \":,'-(\", ';(', ';-('],\r\n        tongue: [':P', ':-P'],\r\n        sunglasses: ['8-)', 'B-)'],\r\n        sweat: [',:(', ',:-('],\r\n        unamused: [':s', ':-S', ':z', ':-Z', ':$', ':-$'],\r\n        wink: [';)', ';-)']\r\n    };\r\n    var _loop_1 = function (shortcode) {\r\n        var emoji = shortcodeDict[shortcode];\r\n        if (!emoji)\r\n            return \"continue\";\r\n        sc[shortcode].forEach(function (emoticon) { dest[emoticon] = emoji; });\r\n    };\r\n    for (var shortcode in sc) {\r\n        _loop_1(shortcode);\r\n    }\r\n}\r\nexport function loadShortCodes(dest) {\r\n    /** source https://gist.github.com/rxaviers/7360908 */\r\n    var parts = [\r\n        \"smile:😄;laughing:😆;blush:😊;smiley:😃;relaxed:☺️;smirk:😏;heart_eyes:😍;kissing_heart:😘;kissing_closed_eyes:😚;flushed:😳;relieved:😌;satisfied:😆;grin:😁;wink:😉;stuck_out_tongue_winking_eye:😜;stuck_out_tongue_closed_eyes:😝;grinning:😀;kissing:😗;kissing_smiling_eyes:😙;stuck_out_tongue:😛;sleeping:😴;worried:😟;frowning:😦;anguished:😧;open_mouth:😮;grimacing:😬;confused:😕;hushed:😯;expressionless:😑;unamused:😒;sweat_smile:😅;sweat:😓;disappointed_relieved:😥;weary:😩;pensive:😔;disappointed:😞;confounded:😖;fearful:😨;cold_sweat:😰;persevere:😣;cry:😢;sob:😭;joy:😂;astonished:😲;scream:😱;tired_face:😫;angry:😠;rage:😡;triumph:😤;sleepy:😪;yum:😋;mask:😷;sunglasses:😎;dizzy_face:😵;imp:👿;smiling_imp:😈;neutral_face:😐;no_mouth:😶;innocent:😇;alien:👽;yellow_heart:💛;blue_heart:💙;purple_heart:💜;heart:❤️;green_heart:💚;broken_heart:💔;heartbeat:💓;heartpulse:💗;two_hearts:💕;revolving_hearts:💞;cupid:💘;sparkling_heart:💖;sparkles:✨;star:⭐️;star2:🌟;dizzy:💫;boom:💥;collision:💥;anger:💢;exclamation:❗️;question:❓;grey_exclamation:❕;grey_question:❔;zzz:💤;dash:💨;sweat_drops:💦;notes:🎶;musical_note:🎵;fire:🔥;hankey:💩;poop:💩;shit:💩;\",\r\n        \"+1:👍;thumbsup:👍;-1:👎;thumbsdown:👎;ok_hand:👌;punch:👊;facepunch:👊;fist:✊;v:✌️;wave:👋;hand:✋;raised_hand:✋;open_hands:👐;point_up:☝️;point_down:👇;point_left:👈;point_right:👉;raised_hands:🙌;pray:🙏;point_up_2:👆;clap:👏;muscle:💪;metal:🤘;fu:🖕;walking:🚶;runner:🏃;running:🏃;couple:👫;family:👪;two_men_holding_hands:👬;two_women_holding_hands:👭;dancer:💃;dancers:👯;ok_woman:🙆;no_good:🙅;information_desk_person:💁;raising_hand:🙋;bride_with_veil:👰;person_with_pouting_face:🙎;person_frowning:🙍;bow:🙇;couplekiss::couplekiss:;couple_with_heart:💑;massage:💆;haircut:💇;nail_care:💅;boy:👦;girl:👧;woman:👩;man:👨;baby:👶;older_woman:👵;older_man:👴;person_with_blond_hair:👱;man_with_gua_pi_mao:👲;man_with_turban:👳;construction_worker:👷;cop:👮;angel:👼;princess:👸;smiley_cat:😺;smile_cat:😸;heart_eyes_cat:😻;kissing_cat:😽;smirk_cat:😼;scream_cat:🙀;crying_cat_face:😿;joy_cat:😹;pouting_cat:😾;japanese_ogre:👹;japanese_goblin:👺;see_no_evil:🙈;hear_no_evil:🙉;speak_no_evil:🙊;guardsman:💂;skull:💀;feet:🐾;lips:👄;kiss:💋;droplet:💧;ear:👂;eyes:👀;nose:👃;tongue:👅;love_letter:💌;bust_in_silhouette:👤;busts_in_silhouette:👥;speech_balloon:💬;\",\r\n        \"thought_balloon:💭;sunny:☀️;umbrella:☔️;cloud:☁️;snowflake:❄️;snowman:⛄️;zap:⚡️;cyclone:🌀;foggy:🌁;ocean:🌊;cat:🐱;dog:🐶;mouse:🐭;hamster:🐹;rabbit:🐰;wolf:🐺;frog:🐸;tiger:🐯;koala:🐨;bear:🐻;pig:🐷;pig_nose:🐽;cow:🐮;boar:🐗;monkey_face:🐵;monkey:🐒;horse:🐴;racehorse:🐎;camel:🐫;sheep:🐑;elephant:🐘;panda_face:🐼;snake:🐍;bird:🐦;baby_chick:🐤;hatched_chick:🐥;hatching_chick:🐣;chicken:🐔;penguin:🐧;turtle:🐢;bug:🐛;honeybee:🐝;ant:🐜;beetle:🐞;snail:🐌;octopus:🐙;tropical_fish:🐠;fish:🐟;whale:🐳;whale2:🐋;dolphin:🐬;cow2:🐄;ram:🐏;rat:🐀;water_buffalo:🐃;tiger2:🐅;rabbit2:🐇;dragon:🐉;goat:🐐;rooster:🐓;dog2:🐕;pig2:🐖;mouse2:🐁;ox:🐂;dragon_face:🐲;blowfish:🐡;crocodile:🐊;dromedary_camel:🐪;leopard:🐆;cat2:🐈;poodle:🐩;paw_prints:🐾;bouquet:💐;cherry_blossom:🌸;tulip:🌷;four_leaf_clover:🍀;rose:🌹;sunflower:🌻;hibiscus:🌺;maple_leaf:🍁;leaves:🍃;fallen_leaf:🍂;herb:🌿;mushroom:🍄;cactus:🌵;palm_tree:🌴;evergreen_tree:🌲;deciduous_tree:🌳;chestnut:🌰;seedling:🌱;blossom:🌼;ear_of_rice:🌾;shell:🐚;globe_with_meridians:🌐;sun_with_face:🌞;full_moon_with_face:🌝;new_moon_with_face:🌚;new_moon:🌑;waxing_crescent_moon:🌒;first_quarter_moon:🌓;waxing_gibbous_moon:🌔;full_moon:🌕;waning_gibbous_moon:🌖;last_quarter_moon:🌗;waning_crescent_moon:🌘;last_quarter_moon_with_face:🌜;\",\r\n        \"first_quarter_moon_with_face:🌛;moon:🌔;earth_africa:🌍;earth_americas:🌎;earth_asia:🌏;volcano:🌋;milky_way:🌌;partly_sunny:⛅️;bamboo:🎍;gift_heart:💝;dolls:🎎;school_satchel:🎒;mortar_board:🎓;flags:🎏;fireworks:🎆;sparkler:🎇;wind_chime:🎐;rice_scene:🎑;jack_o_lantern:🎃;ghost:👻;santa:🎅;christmas_tree:🎄;gift:🎁;bell:🔔;no_bell:🔕;tanabata_tree:🎋;tada:🎉;confetti_ball:🎊;balloon:🎈;crystal_ball:🔮;cd:💿;dvd:📀;floppy_disk:💾;camera:📷;video_camera:📹;movie_camera:🎥;computer:💻;tv:📺;iphone:📱;phone:☎️;telephone:☎️;telephone_receiver:📞;pager:📟;fax:📠;minidisc:💽;vhs:📼;sound:🔉;speaker:🔈;mute:🔇;loudspeaker:📢;mega:📣;hourglass:⌛️;hourglass_flowing_sand:⏳;alarm_clock:⏰;watch:⌚️;radio:📻;satellite:📡;loop:➿;mag:🔍;mag_right:🔎;unlock:🔓;lock:🔒;lock_with_ink_pen:🔏;closed_lock_with_key:🔐;key:🔑;bulb:💡;flashlight:🔦;high_brightness:🔆;low_brightness:🔅;electric_plug:🔌;battery:🔋;calling:📲;email:✉️;mailbox:📫;postbox:📮;bath:🛀;bathtub:🛁;shower:🚿;toilet:🚽;wrench:🔧;nut_and_bolt:🔩;hammer:🔨;seat:💺;moneybag:💰;yen:💴;dollar:💵;pound:💷;euro:💶;\",\r\n        \"credit_card:💳;money_with_wings:💸;e-mail:📧;inbox_tray:📥;outbox_tray:📤;envelope:✉️;incoming_envelope:📨;postal_horn:📯;mailbox_closed:📪;mailbox_with_mail:📬;mailbox_with_no_mail:📭;door:🚪;smoking:🚬;bomb:💣;gun:🔫;hocho:🔪;pill:💊;syringe:💉;page_facing_up:📄;page_with_curl:📃;bookmark_tabs:📑;bar_chart:📊;chart_with_upwards_trend:📈;chart_with_downwards_trend:📉;scroll:📜;clipboard:📋;calendar:📆;date:📅;card_index:📇;file_folder:📁;open_file_folder:📂;scissors:✂️;pushpin:📌;paperclip:📎;black_nib:✒️;pencil2:✏️;straight_ruler:📏;triangular_ruler:📐;closed_book:📕;green_book:📗;blue_book:📘;orange_book:📙;notebook:📓;notebook_with_decorative_cover:📔;ledger:📒;books:📚;bookmark:🔖;name_badge:📛;microscope:🔬;telescope:🔭;newspaper:📰;football:🏈;basketball:🏀;soccer:⚽️;baseball:⚾️;tennis:🎾;8ball:🎱;\",\r\n        \"rugby_football:🏉;bowling:🎳;golf:⛳️;mountain_bicyclist:🚵;bicyclist:🚴;horse_racing:🏇;snowboarder:🏂;swimmer:🏊;surfer:🏄;ski:🎿;spades:♠️;hearts:♥️;clubs:♣️;diamonds:♦️;gem:💎;ring:💍;trophy:🏆;musical_score:🎼;musical_keyboard:🎹;violin:🎻;space_invader:👾;video_game:🎮;black_joker:🃏;flower_playing_cards:🎴;game_die:🎲;dart:🎯;mahjong:🀄️;clapper:🎬;memo:📝;pencil:📝;book:📖;art:🎨;microphone:🎤;headphones:🎧;trumpet:🎺;saxophone:🎷;guitar:🎸;shoe:👞;sandal:👡;high_heel:👠;lipstick:💄;boot:👢;shirt:👕;tshirt:👕;necktie:👔;womans_clothes:👚;dress:👗;running_shirt_with_sash:🎽;jeans:👖;kimono:👘;bikini:👙;ribbon:🎀;tophat:🎩;crown:👑;womans_hat:👒;mans_shoe:👞;closed_umbrella:🌂;briefcase:💼;handbag:👜;pouch:👝;purse:👛;eyeglasses:👓;fishing_pole_and_fish:🎣;coffee:☕️;tea:🍵;sake:🍶;baby_bottle:🍼;beer:🍺;beers:🍻;cocktail:🍸;tropical_drink:🍹;wine_glass:🍷;fork_and_knife:🍴;pizza:🍕;hamburger:🍔;fries:🍟;poultry_leg:🍗;meat_on_bone:🍖;spaghetti:🍝;curry:🍛;fried_shrimp:🍤;bento:🍱;sushi:🍣;fish_cake:🍥;rice_ball:🍙;rice_cracker:🍘;rice:🍚;\",\r\n        \"ramen:🍜;stew:🍲;oden:🍢;dango:🍡;egg:🥚;bread:🍞;doughnut:🍩;custard:🍮;icecream:🍦;ice_cream:🍨;shaved_ice:🍧;birthday:🎂;cake:🍰;cookie:🍪;chocolate_bar:🍫;candy:🍬;lollipop:🍭;honey_pot:🍯;apple:🍎;green_apple:🍏;tangerine:🍊;lemon:🍋;cherries:🍒;grapes:🍇;watermelon:🍉;strawberry:🍓;peach:🍑;melon:🍈;banana:🍌;pear:🍐;pineapple:🍍;sweet_potato:🍠;eggplant:🍆;tomato:🍅;corn:🌽;house:🏠;house_with_garden:🏡;school:🏫;office:🏢;post_office:🏣;hospital:🏥;bank:🏦;convenience_store:🏪;love_hotel:🏩;hotel:🏨;wedding:💒;church:⛪️;department_store:🏬;european_post_office:🏤;city_sunrise:🌇;city_sunset:🌆;japanese_castle:🏯;european_castle:🏰;tent:⛺️;factory:🏭;tokyo_tower:🗼;japan:🗾;mount_fuji:🗻;sunrise_over_mountains:🌄;sunrise:🌅;stars:🌠;statue_of_liberty:🗽;bridge_at_night:🌉;carousel_horse:🎠;rainbow:🌈;ferris_wheel:🎡;fountain:⛲️;roller_coaster:🎢;ship:🚢;speedboat:🚤;boat:⛵️;sailboat:⛵️;rowboat:🚣;anchor:⚓️;rocket:🚀;airplane:✈️;helicopter:🚁;steam_locomotive:🚂;tram:🚊;mountain_railway:🚞;bike:🚲;aerial_tramway:🚡;suspension_railway:🚟;\",\r\n        \"mountain_cableway:🚠;tractor:🚜;blue_car:🚙;oncoming_automobile:🚘;car:🚗;red_car:🚗;taxi:🚕;oncoming_taxi:🚖;articulated_lorry:🚛;bus:🚌;oncoming_bus:🚍;rotating_light:🚨;police_car:🚓;oncoming_police_car:🚔;fire_engine:🚒;ambulance:🚑;minibus:🚐;truck:🚚;train:🚋;station:🚉;train2:🚆;bullettrain_front:🚅;bullettrain_side:🚄;light_rail:🚈;monorail:🚝;railway_car:🚃;trolleybus:🚎;ticket:🎫;fuelpump:⛽️;vertical_traffic_light:🚦;traffic_light:🚥;warning:⚠️;construction:🚧;beginner:🔰;atm:🏧;slot_machine:🎰;busstop:🚏;barber:💈;hotsprings:♨️;checkered_flag:🏁;crossed_flags:🎌;izakaya_lantern:🏮;moyai:🗿;circus_tent:🎪;performing_arts:🎭;round_pushpin:📍;triangular_flag_on_post:🚩;jp:🇯🇵;kr:🇰🇷;cn:🇨🇳;us:🇺🇸;fr:🇫🇷;es:🇪🇸;it:🇮🇹;ru:🇷🇺;gb:🇬🇧;uk:🇬🇧;de:🇩🇪;one:1️⃣;two:2️⃣;three:3️⃣;four:4️⃣;five:5️⃣;six:6️⃣;seven:7️⃣;eight:8️⃣;nine:9️⃣;keycap_ten:🔟;\",\r\n        \"1234:🔢;zero:0️⃣;hash:#️⃣;symbols:🔣;arrow_backward:◀️;arrow_down:⬇️;arrow_forward:▶️;arrow_left:⬅️;capital_abcd:🔠;abcd:🔡;abc:🔤;arrow_lower_left:↙️;arrow_lower_right:↘️;arrow_right:➡️;arrow_up:⬆️;arrow_upper_left:↖️;arrow_upper_right:↗️;arrow_double_down:⏬;arrow_double_up:⏫;arrow_down_small:🔽;arrow_heading_down:⤵️;arrow_heading_up:⤴️;leftwards_arrow_with_hook:↩️;arrow_right_hook:↪️;left_right_arrow:↔️;arrow_up_down:↕️;arrow_up_small:🔼;arrows_clockwise:🔃;arrows_counterclockwise:🔄;rewind:⏪;fast_forward:⏩;information_source:ℹ️;ok:🆗;twisted_rightwards_arrows:🔀;repeat:🔁;repeat_one:🔂;new:🆕;top:🔝;up:🆙;cool:🆒;free:🆓;ng:🆖;cinema:🎦;koko:🈁;signal_strength:📶;u5272:🈹;u5408:🈴;u55b6:🈺;u6307:🈯️;u6708:🈷️;u6709:🈶;u6e80:🈵;u7121:🈚️;u7533:🈸;u7a7a:🈳;u7981:🈲;sa:🈂️;restroom:🚻;mens:🚹;womens:🚺;baby_symbol:🚼;no_smoking:🚭;\",\r\n        \"parking:🅿️;wheelchair:♿️;metro:🚇;baggage_claim:🛄;accept:🉑;wc:🚾;potable_water:🚰;put_litter_in_its_place:🚮;secret:㊙️;congratulations:㊗️;m:Ⓜ️;passport_control:🛂;left_luggage:🛅;customs:🛃;ideograph_advantage:🉐;cl:🆑;sos:🆘;id:🆔;no_entry_sign:🚫;underage:🔞;no_mobile_phones:📵;do_not_litter:🚯;non-potable_water:🚱;no_bicycles:🚳;no_pedestrians:🚷;children_crossing:🚸;no_entry:⛔️;eight_spoked_asterisk:✳️;eight_pointed_black_star:✴️;heart_decoration:💟;vs:🆚;vibration_mode:📳;mobile_phone_off:📴;chart:💹;currency_exchange:💱;aries:♈️;taurus:♉️;gemini:♊️;cancer:♋️;leo:♌️;virgo:♍️;libra:♎️;scorpius:♏️;\",\r\n        \"sagittarius:♐️;capricorn:♑️;aquarius:♒️;pisces:♓️;ophiuchus:⛎;six_pointed_star:🔯;negative_squared_cross_mark:❎;a:🅰️;b:🅱️;ab:🆎;o2:🅾️;diamond_shape_with_a_dot_inside:💠;recycle:♻️;end:🔚;on:🔛;soon:🔜;clock1:🕐;clock130:🕜;clock10:🕙;clock1030:🕥;clock11:🕚;clock1130:🕦;clock12:🕛;clock1230:🕧;clock2:🕑;clock230:🕝;clock3:🕒;clock330:🕞;clock4:🕓;clock430:🕟;clock5:🕔;clock530:🕠;clock6:🕕;clock630:🕡;clock7:🕖;clock730:🕢;clock8:🕗;clock830:🕣;clock9:🕘;clock930:🕤;heavy_dollar_sign:💲;copyright:©️;registered:®️;tm:™️;x:❌;heavy_exclamation_mark:❗️;bangbang:‼️;interrobang:⁉️;o:⭕️;heavy_multiplication_x:✖️;\",\r\n        \"heavy_plus_sign:➕;heavy_minus_sign:➖;heavy_division_sign:➗;white_flower:💮;100:💯;heavy_check_mark:✔️;ballot_box_with_check:☑️;radio_button:🔘;link:🔗;curly_loop:➰;wavy_dash:〰️;part_alternation_mark:〽️;trident:🔱;black_square::black_square:;white_square::white_square:;white_check_mark:✅;black_square_button:🔲;white_square_button:🔳;black_circle:⚫️;white_circle:⚪️;red_circle:🔴;large_blue_circle:🔵;large_blue_diamond:🔷;large_orange_diamond:🔶;small_blue_diamond:🔹;small_orange_diamond:🔸;small_red_triangle:🔺;small_red_triangle_down:🔻\",\r\n    ];\r\n    var matRE = /([^:]+):([^;]+);/g;\r\n    var t;\r\n    for (var i = 0; i < parts.length; i++) {\r\n        matRE.lastIndex = 0;\r\n        while (t = matRE.exec(parts[i])) {\r\n            dest[t[1]] = t[2];\r\n        }\r\n    }\r\n}\r\n","import { elt, setCaretAfter, insertAfter } from \"../dom\";\r\nvar renderer = defaultRenderer;\r\nexport function getMathRenderer() { return renderer; }\r\nexport function setMathRenderer(r) { renderer = r || defaultRenderer; }\r\nfunction defaultRenderer(formula, displayMode) {\r\n    var src = 'http://latex.codecogs.com/gif.latex?' + encodeURIComponent(formula);\r\n    var img = elt('img', {\r\n        src: src,\r\n        alt: formula,\r\n        title: formula,\r\n        'data-formula': formula,\r\n    });\r\n    return img;\r\n}\r\nfunction transformMath(caret) {\r\n    if (caret.nodeType !== Node.TEXT_NODE)\r\n        return 0 /* FAILED */;\r\n    var text = caret.textContent;\r\n    var mat = text.match(/(\\${1,2})([^\\$]+)\\1$/);\r\n    if (!mat)\r\n        return 0 /* FAILED */;\r\n    var expr = mat[2], displayMode = mat[1].length == 2;\r\n    var mathEl = renderer(expr, displayMode);\r\n    if (!mathEl)\r\n        return 0 /* FAILED */;\r\n    caret.textContent = text.slice(0, -mat[0].length);\r\n    insertAfter(mathEl, caret);\r\n    setCaretAfter(mathEl);\r\n    return 1 /* SUCCESS */;\r\n}\r\nexport default transformMath;\r\n","import { wrapCode } from \"../transformer/inline-collection\";\r\nimport { findUpward, breakElement, setCaretAfter, getContextDocument } from \"../dom\";\r\nimport { handleKeyboardEvent } from \"./table-keys\";\r\nfunction handleFormattingKeys(ev) {\r\n    var ctrl = ev.ctrlKey, shift = ev.shiftKey, alt = ev.altKey, which = ev.which;\r\n    var document = getContextDocument();\r\n    if (false) { }\r\n    else if (ctrl && !shift && !alt && which == 73) /* Ctrl+I */\r\n        document.execCommand(\"italic\");\r\n    else if (ctrl && !shift && !alt && which == 66) /* Ctrl+B */\r\n        document.execCommand(\"bold\");\r\n    else if (ctrl && !shift && !alt && which == 85) /* Ctrl+U */\r\n        document.execCommand(\"underline\");\r\n    else if (ctrl && shift && !alt && which == 61) /* Ctrl+Shift+= */\r\n        document.execCommand(\"superscript\");\r\n    else if (ctrl && !shift && !alt && which == 61) /* Ctrl+= */\r\n        document.execCommand(\"subscript\");\r\n    else if (ctrl && !shift && !alt && which == 76) /* Ctrl+L */\r\n        document.execCommand(\"justifyLeft\");\r\n    else if (ctrl && !shift && !alt && which == 69) /* Ctrl+E */\r\n        document.execCommand(\"justifyCenter\");\r\n    else if (ctrl && !shift && !alt && which == 82) /* Ctrl+R */\r\n        document.execCommand(\"justifyRight\");\r\n    else\r\n        return false;\r\n    return true;\r\n}\r\nfunction toggleInlineElement(ev) {\r\n    var ctrl = ev.ctrlKey, shift = ev.shiftKey, alt = ev.altKey, which = ev.which;\r\n    if (ctrl || shift || alt)\r\n        return false;\r\n    var document = getContextDocument();\r\n    var sel = document.getSelection();\r\n    if (sel.isCollapsed)\r\n        return false;\r\n    var caret = sel.focusNode;\r\n    if (caret.nodeType === Node.ELEMENT_NODE)\r\n        caret = caret.childNodes[sel.focusOffset] || caret;\r\n    var range = sel.getRangeAt(0);\r\n    if (which === 192) /* ` */ {\r\n        var code = findUpward(caret, function (el) { return el.nodeName.toLowerCase() === 'code'; });\r\n        if (code) {\r\n            var newCaretAfter = code.lastChild;\r\n            breakElement(code);\r\n            setCaretAfter(newCaretAfter);\r\n        }\r\n        else {\r\n            code = wrapCode(range);\r\n            setCaretAfter(code);\r\n        }\r\n    }\r\n    else\r\n        return false;\r\n    return true;\r\n}\r\nexport default function bindShortkeys(editor) {\r\n    editor.addEventListener('keydown', function (ev) {\r\n        try {\r\n            var handled = false /* add a `false` to align the following methods */\r\n                || handleFormattingKeys(ev)\r\n                || toggleInlineElement(ev)\r\n                || handleKeyboardEvent(ev); // table keys\r\n            if (!handled)\r\n                return;\r\n        }\r\n        catch (err) {\r\n            return;\r\n        }\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n    }, false);\r\n}\r\n","import { findUpward, setCaret, makeLine, replace, insertAfter, elt, makeBr, getContextDocument } from \"../dom\";\r\n/**\r\n * Handle keyboard events for table. Now supports:\r\n *\r\n * - Insert: insert a column\r\n * - Tab: goto next cell, or insert a row\r\n * - Backspace: delete empty row\r\n * - Del: delete empty row\r\n * - Up/Down/Left/Right: navigate between cells\r\n *\r\n * @returns {boolean} handled or not\r\n */\r\nexport function handleKeyboardEvent(ev) {\r\n    var keyCode = ev.keyCode || ev.which;\r\n    var noAdditionalKeys = !(ev.shiftKey || ev.ctrlKey || ev.altKey);\r\n    if ((keyCode !== 8) && //BACKSPACE\r\n        (keyCode !== 45) && //INSERT\r\n        (keyCode !== 46) && //DELETE\r\n        (keyCode !== 9) && //TAB\r\n        (keyCode !== 13) && //ENTER\r\n        (keyCode < 37 || keyCode > 40))\r\n        return false;\r\n    var selection = getContextDocument().getSelection();\r\n    if (!selection.isCollapsed)\r\n        return false;\r\n    var td = findUpward(selection.focusNode, function (el) { return /^t[dh]$/i.test(el.nodeName); });\r\n    var tr = findUpward(td, function (el) { return /^tr$/i.test(el.nodeName); });\r\n    var table = findUpward(tr, function (el) { return /^table$/i.test(el.nodeName); });\r\n    if (!td || !tr || !table)\r\n        return false;\r\n    var td_index = 0; // the index of current td\r\n    var td_count = tr.childElementCount;\r\n    while (td_index < td_count && tr.children[td_index] !== td)\r\n        td_index++;\r\n    if (td_index >= td_count)\r\n        return false; // not found the cell. awkward but shall not happen\r\n    var focus = null;\r\n    function removeRow() {\r\n        if (noAdditionalKeys && !tr.textContent.trim()) {\r\n            focus = tr.nextElementSibling || table.nextElementSibling;\r\n            if (!focus)\r\n                insertAfter(focus = makeLine(), table);\r\n            else if (focus.firstElementChild)\r\n                focus = focus.firstElementChild;\r\n            tr.parentElement.removeChild(tr);\r\n        }\r\n    }\r\n    function removeWholeTable() {\r\n        focus = table.nextElementSibling;\r\n        if (!focus)\r\n            replace(table, focus = makeLine());\r\n        else\r\n            table.parentElement.removeChild(table);\r\n    }\r\n    function removeColumn() {\r\n        var trs = table.querySelectorAll('tr');\r\n        for (var i = 0; i < trs.length; i++) {\r\n            var tr_1 = trs[i];\r\n            var refTd = tr_1.children[td_index];\r\n            tr_1.removeChild(refTd);\r\n        }\r\n    }\r\n    function insertColumn() {\r\n        if (!ev.shiftKey)\r\n            td_index++; //insert column after the current\r\n        var trs = table.querySelectorAll('tr');\r\n        for (var i = 0; i < trs.length; i++) {\r\n            var tr_2 = trs[i];\r\n            var refTd = tr_2.children[td_index];\r\n            var newTd = elt(refTd.nodeName, null, [makeBr()]);\r\n            tr_2.insertBefore(newTd, refTd);\r\n        }\r\n        focus = tr.children[td_index];\r\n    }\r\n    function insertRow(focusCell) {\r\n        var newTr = elt('tr');\r\n        for (var i = 0; i < tr.childNodes.length; i++)\r\n            newTr.appendChild(elt('td'));\r\n        focus = newTr.children[focusCell || 0] || newTr.firstElementChild; // first new cell\r\n        focus.appendChild(makeBr());\r\n        insertAfter(newTr, tr);\r\n    }\r\n    switch (keyCode) {\r\n        case 13: //ENTER: maybe end a table\r\n            if (noAdditionalKeys) {\r\n                if (\"\" === tr.textContent.trim())\r\n                    removeRow();\r\n                else\r\n                    insertRow(td_index);\r\n            }\r\n            break;\r\n        case 46: //DELETE\r\n        case 8: //BACKSPACE\r\n            if (noAdditionalKeys && td.nodeName === \"TH\" && !td.textContent.trim()) {\r\n                // Caret is in the heading row, an empty column.\r\n                focus = (keyCode === 46 && td.nextElementSibling) || td.previousElementSibling;\r\n                if (!focus)\r\n                    removeWholeTable(); // No more column! the whole table is deleted.\r\n                else\r\n                    removeColumn(); // Remove a column\r\n            }\r\n            else {\r\n                removeRow();\r\n            }\r\n            break;\r\n        case 45: //INSERT\r\n            insertColumn();\r\n            break;\r\n        case 9: //TAB\r\n            if (noAdditionalKeys) {\r\n                focus = td.nextElementSibling ||\r\n                    (tr.nextElementSibling && tr.nextElementSibling.firstElementChild);\r\n                if (!focus)\r\n                    insertRow(); // create a row?\r\n            }\r\n            else if (ev.shiftKey) {\r\n                focus = td.previousElementSibling ||\r\n                    (tr.previousElementSibling && tr.previousElementSibling.lastElementChild) ||\r\n                    table.previousElementSibling;\r\n            }\r\n            break;\r\n        case 38: //UP\r\n            if (noAdditionalKeys) {\r\n                focus = (tr.previousElementSibling && tr.previousElementSibling.children[td_index]) ||\r\n                    table.previousElementSibling;\r\n            }\r\n            break;\r\n        case 40: //DOWN\r\n            if (noAdditionalKeys) {\r\n                focus = (tr.nextElementSibling && tr.nextElementSibling.children[td_index]) ||\r\n                    table.nextElementSibling;\r\n            }\r\n            break;\r\n    }\r\n    if (focus) {\r\n        setCaret(focus);\r\n        ev.preventDefault();\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n","import { setCaret, replace, insertAfter, makeBr, makeLine } from \"../dom\";\r\n/**\r\n * Move line to higher level wrapper\r\n *\r\n * - NewWrapper\r\n *   - OldWrapper\r\n *     - Line\r\n *\r\n * eg: From\r\n *\r\n * - #editor\r\n *   - blockquote\r\n *      - p {caret here}\r\n *\r\n * To\r\n *\r\n * - #editor\r\n *   - blockquote\r\n *   - p {caret here}\r\n */\r\nfunction tryHoistBlock(caret, line) {\r\n    // maybe leave a codefence?\r\n    if (line.nodeName.toLowerCase() === 'pre') {\r\n        var pre = line, mat = caret.textContent.match(/(^|[\\r\\n])```+$/);\r\n        if (mat) {\r\n            caret.textContent = caret.textContent.slice(0, -mat[0].length);\r\n            if (caret.nextSibling && caret.nextSibling.nodeName.toLowerCase() === 'br') {\r\n                caret.parentNode.removeChild(caret.nextSibling);\r\n            }\r\n            if (caret.previousSibling && caret.previousSibling.nodeName.toLowerCase() === 'br') {\r\n                caret.parentNode.removeChild(caret.previousSibling);\r\n            }\r\n            var br_1 = makeBr();\r\n            var newLine = makeLine();\r\n            insertAfter(newLine, pre);\r\n            setCaret(newLine);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    // if line is not empty, do not try hoisting it\r\n    if (line.textContent || line.querySelector('img,video,audio,object'))\r\n        return false;\r\n    var oldWrapper = line.parentNode;\r\n    if (!/^(?:ul|ol|blockquote)$/i.test(oldWrapper.nodeName))\r\n        return false;\r\n    var newWrapper = oldWrapper.parentNode;\r\n    newWrapper.insertBefore(line, oldWrapper.nextSibling);\r\n    if (oldWrapper.childNodes.length == 0)\r\n        newWrapper.removeChild(oldWrapper);\r\n    if (!/^(?:ul|ol)$/i.test(newWrapper.nodeName) && line.nodeName.toLowerCase() === 'li') {\r\n        // leaving a list ? convert <li> to <p>\r\n        var newLine = makeLine(line.childNodes);\r\n        replace(line, newLine);\r\n        line = newLine;\r\n    }\r\n    // create a bogus <br>\r\n    var br = line.querySelector('br');\r\n    if (!br) {\r\n        br = makeBr();\r\n        caret.appendChild(br);\r\n    }\r\n    setCaret(br.parentNode);\r\n    return true;\r\n}\r\nexport default tryHoistBlock;\r\n","export var ToastStatus;\r\n(function (ToastStatus) {\r\n    ToastStatus[ToastStatus[\"Hidden\"] = 0] = \"Hidden\";\r\n    ToastStatus[ToastStatus[\"Shown\"] = 1] = \"Shown\";\r\n    ToastStatus[ToastStatus[\"Hiding\"] = 2] = \"Hiding\";\r\n})(ToastStatus || (ToastStatus = {}));\r\n;\r\n/**\r\n * Tooltip Box, or a Toast on Android.\r\n *\r\n * Providing a static method `showToast(text, coveron[, timeout])`, or you can construct one and control its visibility.\r\n */\r\nvar Toast = /** @class */ (function () {\r\n    function Toast(document, text) {\r\n        this.status = ToastStatus.Hidden;\r\n        this.document = document;\r\n        var ele = document.createElement(\"div\");\r\n        ele.setAttribute(\"style\", Toast.style);\r\n        ele.textContent = text;\r\n        ele.addEventListener('mousedown', this.dismiss.bind(this), false);\r\n        this.element = ele;\r\n    }\r\n    Toast.prototype.setPosition = function (left, topOrBottom, isBottom) {\r\n        var ele = this.element;\r\n        ele.style.left = left + 'px';\r\n        ele.style.top = isBottom && 'initial' || (topOrBottom + 'px');\r\n        ele.style.bottom = isBottom && (topOrBottom + 'px') || 'initial';\r\n    };\r\n    Toast.prototype.show = function (timeout) {\r\n        var _this = this;\r\n        var ele = this.element;\r\n        var dismiss = this.dismiss.bind(this);\r\n        if (!ele.parentElement)\r\n            this.document.body.appendChild(ele);\r\n        setTimeout(function () {\r\n            _this.status = ToastStatus.Shown;\r\n            ele.style.opacity = '1';\r\n            ele.style.marginTop = '0';\r\n            if (timeout)\r\n                setTimeout(dismiss, timeout);\r\n        }, 10);\r\n    };\r\n    Toast.prototype.dismiss = function () {\r\n        var _this = this;\r\n        if (this.status !== ToastStatus.Shown)\r\n            return;\r\n        this.status = ToastStatus.Hiding;\r\n        var ele = this.element;\r\n        ele.style.opacity = '0';\r\n        ele.style.marginTop = '-10px';\r\n        setTimeout(function () {\r\n            ele.parentNode.removeChild(ele);\r\n            _this.status = ToastStatus.Hidden;\r\n        }, 300);\r\n    };\r\n    /**\r\n     * A Quick way to show a temporary Toast over an Element.\r\n     *\r\n     * @param {string} text     message to be shown\r\n     * @param {Element} ref     the location reference\r\n     * @param {number} timeout  time in ms. 0 = do not dismiss.\r\n     * @param {boolean} cover   true = cover on the ref. false = shown on top of the ref.\r\n     */\r\n    Toast.showToast = function (text, ref, timeout, cover) {\r\n        var document = ref.ownerDocument;\r\n        var rect = ref['getBoundingClientRect'] && ref.getBoundingClientRect() || { left: 0, top: 0 };\r\n        var toast = new Toast(document, text);\r\n        var x = rect.left + document.body.scrollLeft;\r\n        var y = rect.top + document.body.scrollTop;\r\n        toast.setPosition(x, y, !cover);\r\n        toast.show(timeout);\r\n        return toast;\r\n    };\r\n    Toast.SHORT = 1500;\r\n    Toast.LONG = 3500;\r\n    Toast.style = \"\\nposition: absolute;\\nfont-family: sans-serif;\\npadding: 5px 10px;\\nbackground: #e4F68F;\\nfont-size: 10pt;\\nline-height: 1.4em;\\ncolor: #000;\\nz-index: 32760;\\nmargin-top: -10px;\\ntransition: .2s ease;\\nopacity: 0;\\n\";\r\n    return Toast;\r\n}());\r\nexport { Toast };\r\n","/*!\r\n * MarkdownIME by laobubu\r\n * @url https://github.com/laobubu/MarkdownIME\r\n */\r\nimport * as DOM from \"./dom\";\r\nimport { findCaret, setCaret, replace, getLineContainer, findUpward, makeLine, setContextDocument } from \"./dom\";\r\nimport { transformers } from './transformer';\r\nimport bindShortkeys from \"./extra/shortkeys\";\r\nimport tryHoistBlock from \"./extra/leave-block\";\r\nimport tryInsertLine from \"./extra/new-line\";\r\nimport { Toast } from \"./extra/toast\";\r\nimport tryMakeTable from \"./extra/make-table\";\r\nexport { DOM };\r\nexport { getContextDocument, setContextDocument, elt } from \"./dom\";\r\nexport { Toast, ToastStatus } from \"./extra/toast\";\r\nexport { emoticonDict, shortcodeDict as emojiDict } from \"./transformer/emoji\";\r\nexport { getMathRenderer, setMathRenderer } from \"./transformer/math\";\r\n/** Return all content-editable elements inside the window, which could be enhanced by MarkdownIME. */\r\nexport function Scan(window) {\r\n    var document = window.document;\r\n    var candidates = document.querySelectorAll('[contenteditable], [designMode]');\r\n    var editors = [];\r\n    for (var i = 0; i < candidates.length; i++) {\r\n        var candidate = candidates[i];\r\n        var rect = candidate.getBoundingClientRect();\r\n        if (rect.height > 10 && rect.width > 10)\r\n            editors.push(candidate);\r\n    }\r\n    [].forEach.call(document.querySelectorAll('iframe'), function (i) {\r\n        try {\r\n            var result = Scan(i.contentWindow);\r\n            editors.push.apply(editors, result);\r\n        }\r\n        catch (err) {\r\n            //security limit, cannot scan the iframe\r\n        }\r\n    });\r\n    return editors;\r\n}\r\nexport function Enhance(editor, options) {\r\n    if ('length' in editor) {\r\n        var ans = [];\r\n        for (var i = 0; i < editor.length; i++)\r\n            ans.push(EnhanceOne(editor[i], options));\r\n        return ans;\r\n    }\r\n    else {\r\n        return EnhanceOne(editor, options);\r\n    }\r\n}\r\n/** Scan and enhance all editors, then show a notice. */\r\nexport function Bookmarklet(win, options) {\r\n    var opts = { successToast: true };\r\n    if (options) {\r\n        for (var key in options)\r\n            opts[key] = options[key];\r\n    }\r\n    var editableElements = Scan(win || window);\r\n    Enhance(editableElements, opts);\r\n}\r\nfunction EnhanceOne(editor, options) {\r\n    if (!options)\r\n        options = {};\r\n    if (!('noShortkey' in options)) {\r\n        // by default, disable shortkeys in TinyMCE and Quill\r\n        options.noShortkey = editor.id === 'tinymce' || /\\bql-editor\\b/.test(editor.className);\r\n    }\r\n    if (!options.noShortkey)\r\n        bindShortkeys(editor);\r\n    var document = editor.ownerDocument;\r\n    var doTransform = function (enterKey) {\r\n        setContextDocument(document);\r\n        var caretEl = findCaret();\r\n        if (!caretEl)\r\n            return 0 /* FAILED */;\r\n        if (editor === caretEl) {\r\n            caretEl = makeLine();\r\n            editor.appendChild(caretEl);\r\n            setCaret(caretEl);\r\n        }\r\n        else if (caretEl.nodeType === Node.TEXT_NODE && caretEl.parentNode === editor) {\r\n            // make a line container for\r\n            // <div id=\"editor\"> content <b> not </b> wrapped by P or DIV </div>\r\n            var placeholder = document.createComment(\"placeholder\");\r\n            replace(caretEl, placeholder);\r\n            var line = makeLine([caretEl]);\r\n            replace(placeholder, line);\r\n            setCaret(caretEl);\r\n        }\r\n        for (var i = 0; i < transformers.length; i++) {\r\n            var transformer = transformers[i];\r\n            var trResult = transformer(caretEl);\r\n            if (trResult !== 0 /* FAILED */)\r\n                return trResult;\r\n        }\r\n        // no transformer work. Maybe time to handle Enter Key?\r\n        if (enterKey) {\r\n            var isInCodeFence = !!findUpward(caretEl, function (el) { return el.nodeName.toLowerCase() === 'pre'; });\r\n            var line = getLineContainer(caretEl);\r\n            var success = tryHoistBlock(caretEl, line);\r\n            if (!isInCodeFence && !success) {\r\n                success = tryInsertLine(caretEl, line) || tryMakeTable(caretEl, line);\r\n            }\r\n            if (success)\r\n                return 2 /* NEED_PREVENT_DEFAULT */;\r\n        }\r\n        // Everything failed\r\n        return 0 /* FAILED */;\r\n    };\r\n    editor.addEventListener('keypress', function (ev) {\r\n        if (ev.which === 32 || ev.which === 13) { // pressed space key\r\n            var trResult = doTransform(ev.which === 13);\r\n            if (trResult === 2 /* NEED_PREVENT_DEFAULT */)\r\n                ev.preventDefault();\r\n        }\r\n    }, false);\r\n    if (options.successToast)\r\n        Toast.showToast(\"MarkdownIME loaded\", editor, Toast.SHORT, true);\r\n    return { editor: editor, document: document, doTransform: doTransform };\r\n}\r\n","import { insertAfter, setCaretAfter, makeBr } from \"../dom\";\r\nexport default function tryInsertLine(caret, line) {\r\n    var lineNodeName = line.nodeName.toLowerCase();\r\n    if (lineNodeName === 'pre') {\r\n        // Insert new line into <pre> code fence\r\n        // Only Chrome creates another <pre> like <p>, which is not acceptable\r\n        // Other browsers are smart, no need to worry about them.\r\n        if (!/chrome|webkit/i.test(navigator.userAgent))\r\n            return false;\r\n        var cNext = caret.nextSibling;\r\n        if (cNext && cNext.nodeName.toLowerCase() === 'br') {\r\n            insertAfter(makeBr(), cNext);\r\n            setCaretAfter(cNext);\r\n        }\r\n        else {\r\n            var br = makeBr();\r\n            insertAfter(br, caret);\r\n            insertAfter(makeBr(), br);\r\n            setCaretAfter(br);\r\n        }\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n","import { isTextNode, elt, replace, setCaret, makeBr, getContextDocument } from \"../dom\";\r\nexport default function tryMakeTable(caret, line) {\r\n    var nodes = line.childNodes, first = nodes[0], last = nodes[nodes.length - 1];\r\n    // sometime there is an extra <br>, just remove it\r\n    if (last && last.nodeName.toLowerCase() === 'br') {\r\n        line.removeChild(last);\r\n        last = nodes[nodes.length - 1];\r\n    }\r\n    if (!isTextNode(first) || !isTextNode(last))\r\n        return false;\r\n    if (!/^\\s*\\|/.test(first.textContent) || !/\\|\\s*$/.test(last.textContent))\r\n        return false;\r\n    var headerCells = [];\r\n    var currentCell = null;\r\n    function goNextCell() {\r\n        if (currentCell && currentCell.childNodes.length > 0)\r\n            headerCells.push(currentCell);\r\n        currentCell = elt('th');\r\n    }\r\n    goNextCell();\r\n    while (nodes.length > 0) {\r\n        var srcNode = nodes[0];\r\n        if (isTextNode(srcNode)) {\r\n            srcNode.textContent.split(\"|\").forEach(function (text, idx) {\r\n                if (idx > 0)\r\n                    goNextCell();\r\n                if (!/^\\s*$/.test(text))\r\n                    currentCell.appendChild(getContextDocument().createTextNode(text));\r\n            });\r\n            line.removeChild(srcNode);\r\n        }\r\n        else {\r\n            currentCell.appendChild(srcNode);\r\n        }\r\n    }\r\n    goNextCell();\r\n    if (headerCells.length == 0)\r\n        return false;\r\n    var headerRow = elt('tr', null, headerCells);\r\n    var contentRow = elt('tr', null, headerCells.map(function () { return elt('td'); }));\r\n    var table = elt('table', null, [headerRow, contentRow]);\r\n    var contentCell = contentRow.childNodes[0];\r\n    contentCell.appendChild(makeBr());\r\n    replace(line, table);\r\n    setCaret(contentCell);\r\n    return true;\r\n}\r\n"],"sourceRoot":""}