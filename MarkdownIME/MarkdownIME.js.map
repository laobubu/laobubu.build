{"version":3,"sources":["webpack://MarkdownIME/webpack/universalModuleDefinition","webpack://MarkdownIME/webpack/bootstrap","webpack://MarkdownIME/./src/dom/index.ts","webpack://MarkdownIME/./src/transformer/pattern/block.ts","webpack://MarkdownIME/./src/transformer/hr.ts","webpack://MarkdownIME/./src/transformer/header.ts","webpack://MarkdownIME/./src/transformer/blockquote.ts","webpack://MarkdownIME/./src/transformer/ordered-list.ts","webpack://MarkdownIME/./src/transformer/unordered-list.ts","webpack://MarkdownIME/./src/transformer/codefence.ts","webpack://MarkdownIME/./src/dom/textNodeSearch.ts","webpack://MarkdownIME/./src/transformer/pattern/inline.ts","webpack://MarkdownIME/./src/transformer/index.ts","webpack://MarkdownIME/./src/transformer/inline-collection.ts","webpack://MarkdownIME/./src/transformer/link-n-image.ts","webpack://MarkdownIME/./src/transformer/emoji.ts","webpack://MarkdownIME/./src/extra/emoji-data.ts","webpack://MarkdownIME/./src/transformer/math.ts","webpack://MarkdownIME/./src/extra/shortkeys.ts","webpack://MarkdownIME/./src/extra/table-keys.ts","webpack://MarkdownIME/./src/extra/leave-block.ts","webpack://MarkdownIME/./src/extra/toast.ts","webpack://MarkdownIME/./src/index.ts","webpack://MarkdownIME/./src/extra/new-line.ts","webpack://MarkdownIME/./src/extra/make-table.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","win","dom_document","document","setContextDocument","doc","defaultView","getContextDocument","findCaret","sel","getSelection","anchorNode","anchorOffset","isCollapsed","nodeType","Node","ELEMENT_NODE","childNodes","TEXT_NODE","textContent","previousSibling","length","slice","newNode","createTextNode","parentNode","insertBefore","nextSibling","setPosition","setCaret","anchor","offset","collapseToEnd","scrollIntoViewIfNeeded","isTextNode","setCaretAfter","parent","indexOf","getLineContainer","el","findUpward","node","test","nodeName","breakElement","parentElement","frag","createDocumentFragment","appendChild","removeChild","checker","tidy","nodes","base","forwardCnt","forwardText","elt","tag","attrs","content","createElement","attr","val","setAttribute","forEach","child","makeBr","data-bogus","makeLine","replace","old","insertAfter","refNode","getViewport","_window","left","pageXOffset","top","pageYOffset","height","innerHeight","width","innerWidth","right","bottom","rectContains","container","subRect","body","ownerDocument","scrollArg","nodeRect","getBoundingClientRect","containerRect","rectRelation","scrollIntoView","createBlockTransformer","prefix","transformLine","caret","matchResult","match","line","tmpNode","placeHolder","createComment","newLine","err","querySelector","br","transformer_hr","hr","header","blockquote","bqCount","txt","charAt","isInList","tagName","toLowerCase","ans","ordered_list","start","unordered_list","codefence","lang","lastIndexOf","needle","since","ch","createInlineTransformer","doWrap","reserveTag","tagLen","caretIsSafeForInline","caretTextLen","beginPos","endCh","bnt","range","createRange","setStart","setEnd","wrapper","makeWrapFn","surroundContents","wrapCode","wrapBold","wrapItalic","wrapDel","wrapBoldItalic","wrapperOutside","inline_collection","link_n_image","lineNodes","endPos","middlePos","urlRange","url","cloneContents","trim","resultElement","isImage","textRange","src","alt","deleteContents","insertNode","href","junkRange","shortcodeDict","smile","emoticonDict",":)","dest","parts","matRE","lastIndex","exec","loadShortCodes","sc","angry","blush","broken_heart","confused","cry","frowning","heart","two_hearts","imp","innocent","joy","kissing","laughing","neutral","open_mouth","rage","smiley","smiling_imp","sob","tongue","sunglasses","sweat","unamused","wink","_loop_1","shortcode","emoji","emoticon","loadEmoticons","renderer","defaultRenderer","getMathRenderer","setMathRenderer","formula","displayMode","encodeURIComponent","title","data-formula","transformers","concat","text","output","removeCharCount","mat","expr","mathEl","bindShortkeys","editor","addEventListener","ev","ctrl","ctrlKey","shift","shiftKey","altKey","which","execCommand","handleFormattingKeys","focusNode","focusOffset","getRangeAt","code","newCaretAfter","lastChild","toggleInlineElement","keyCode","noAdditionalKeys","selection","td","tr","table","td_index","td_count","childElementCount","children","focus","removeRow","nextElementSibling","firstElementChild","insertRow","focusCell","newTr","previousElementSibling","trs","querySelectorAll","tr_1","refTd","removeColumn","tr_2","newTd","insertColumn","lastElementChild","preventDefault","handleKeyboardEvent","stopPropagation","ToastStatus","leave_block","pre","oldWrapper","newWrapper","Toast","this","status","Hidden","ele","style","dismiss","element","topOrBottom","isBottom","show","timeout","_this","setTimeout","Shown","opacity","marginTop","Hiding","showToast","ref","cover","rect","toast","x","scrollLeft","y","scrollTop","SHORT","LONG","Scan","candidates","editors","candidate","push","result","contentWindow","apply","Enhance","options","EnhanceOne","Bookmarklet","opts","successToast","noShortkey","id","className","doTransform","enterKey","caretEl","placeholder","trResult","transformer","isInCodeFence","success","navigator","userAgent","cNext","tryInsertLine","first","last","headerCells","currentCell","goNextCell","srcNode","split","idx","headerRow","contentRow","map","contentCell","tryMakeTable","__webpack_exports__","dom_namespaceObject"],"mappings":"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","file":"MarkdownIME.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MarkdownIME\"] = factory();\n\telse\n\t\troot[\"MarkdownIME\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/** This file provides some util functions for DOM manipulation */\r\nvar win = window;\r\nvar document = window.document;\r\n/** Set the context document. This will affect some DOM operation like `elt`, `findCaret` */\r\nexport function setContextDocument(doc) {\r\n    document = doc || window.document;\r\n    win = document.defaultView;\r\n}\r\n/**\r\n * Get the context document that currently MarkdownIME is using.\r\n *\r\n * The context affects some DOM operation like `elt`, `findCaret`\r\n */\r\nexport function getContextDocument() {\r\n    return document;\r\n}\r\n/**\r\n * Try to get the node which is exactly before the caret.\r\n */\r\nexport function findCaret() {\r\n    var sel = document.getSelection();\r\n    var anchorNode = sel.anchorNode, anchorOffset = sel.anchorOffset;\r\n    if (!sel.isCollapsed || !anchorNode)\r\n        return null;\r\n    if (anchorNode.nodeType === Node.ELEMENT_NODE) {\r\n        return anchorOffset == 0 ? anchorNode : anchorNode.childNodes[anchorOffset - 1];\r\n    }\r\n    if (anchorNode.nodeType === Node.TEXT_NODE) {\r\n        var textContent = anchorNode.textContent;\r\n        if (anchorOffset == 0)\r\n            return anchorNode.previousSibling;\r\n        if (textContent.length <= anchorOffset)\r\n            return anchorNode;\r\n        // break text node into two\r\n        anchorNode.textContent = textContent.slice(0, anchorOffset);\r\n        var newNode = document.createTextNode(textContent.slice(anchorOffset));\r\n        anchorNode.parentNode.insertBefore(newNode, anchorNode.nextSibling);\r\n        sel.setPosition(anchorNode, anchorOffset);\r\n        return anchorNode;\r\n    }\r\n    return null;\r\n}\r\nexport function setCaret(anchor, offset) {\r\n    var sel = document.getSelection();\r\n    if (!sel.isCollapsed)\r\n        sel.collapseToEnd();\r\n    sel.setPosition(anchor, offset || 0);\r\n    scrollIntoViewIfNeeded((isTextNode(anchor) ? anchor.parentNode : anchor));\r\n}\r\nexport function setCaretAfter(anchor) {\r\n    var parent = anchor.parentNode;\r\n    setCaret(parent, [].indexOf.call(parent.childNodes, anchor) + 1);\r\n    scrollIntoViewIfNeeded((isTextNode(anchor) ? parent : anchor));\r\n}\r\n/**\r\n * Get Line Container Node\r\n */\r\nexport function getLineContainer(el) {\r\n    return findUpward(el, function (node) { return /^(?:div|p|h\\d|pre|body|td|th|li|dt|dd|blockquote)$/i.test(node.nodeName); });\r\n}\r\nexport function breakElement(el) {\r\n    if (!el || !el.parentElement)\r\n        return;\r\n    var parent = el.parentElement;\r\n    var frag = document.createDocumentFragment();\r\n    while (el.childNodes.length)\r\n        frag.appendChild(el.childNodes[0]);\r\n    parent.insertBefore(frag, el);\r\n    parent.removeChild(el);\r\n}\r\nexport function findUpward(el, checker) {\r\n    while (el) {\r\n        if (checker(el))\r\n            return el;\r\n        else\r\n            el = el.parentNode;\r\n    }\r\n    return null;\r\n}\r\n/** tidy one node's childNodes, concate broken text nodes */\r\nexport function tidy(el) {\r\n    var nodes = el.childNodes;\r\n    for (var i = 0; i < nodes.length; i++) {\r\n        var base = nodes[i];\r\n        if (base.nodeType !== Node.TEXT_NODE)\r\n            continue;\r\n        var forwardCnt = 1;\r\n        var forwardText = \"\";\r\n        while (nodes[i + forwardCnt] && nodes[i + forwardCnt].nodeType === Node.TEXT_NODE) {\r\n            forwardText += nodes[i + forwardCnt].textContent;\r\n            forwardCnt++;\r\n        }\r\n        if (forwardCnt > 1) {\r\n            while (forwardCnt-- > 1)\r\n                el.removeChild(nodes[i + 1]);\r\n            base.textContent += forwardText;\r\n        }\r\n        i++;\r\n    }\r\n}\r\nexport function elt(tag, attrs, content) {\r\n    var el = document.createElement(tag);\r\n    if (attrs)\r\n        for (var attr in attrs) {\r\n            var val = attrs[attr];\r\n            el.setAttribute(attr, \"\" + val);\r\n        }\r\n    if (typeof content === 'string')\r\n        el.textContent = content;\r\n    else if (content && content.length > 0)\r\n        [].slice.call(content).forEach(function (child) { return el.appendChild(child); });\r\n    return el;\r\n}\r\n/** create <br> for empty lines */\r\nexport function makeBr() {\r\n    return elt('br', { 'data-bogus': true });\r\n}\r\n/** create <p> for empty lines */\r\nexport function makeLine(content) {\r\n    return elt('p', null, content || [makeBr()]);\r\n}\r\n/** insert new node before old one, then remove old one */\r\nexport function replace(old, newNode) {\r\n    var parent = old && old.parentNode;\r\n    if (!parent)\r\n        return;\r\n    parent.insertBefore(newNode, old);\r\n    parent.removeChild(old);\r\n}\r\n/** insert a node after an existsing one */\r\nexport function insertAfter(newNode, refNode) {\r\n    var parent = refNode && refNode.parentNode;\r\n    if (!parent)\r\n        return;\r\n    parent.insertBefore(newNode, refNode.nextSibling);\r\n}\r\nexport function isTextNode(node) {\r\n    return node && node.nodeType === Node.TEXT_NODE;\r\n}\r\n/**\r\n * get current viewport rect\r\n *\r\n * @returns Non-Standard ClientRect (because IE/Edge not supports DOMRect)\r\n */\r\nexport function getViewport(_window) {\r\n    if (!_window)\r\n        _window = win || window;\r\n    var left = _window.pageXOffset;\r\n    var top = _window.pageYOffset;\r\n    var height = _window.innerHeight;\r\n    var width = _window.innerWidth;\r\n    return {\r\n        left: left, top: top, height: height, width: width,\r\n        right: left + width,\r\n        bottom: top + height,\r\n    };\r\n}\r\nfunction rectContains(container, subRect) {\r\n    if (container.left >= subRect.left)\r\n        return 3 /* LEFT */;\r\n    if (container.right <= subRect.right)\r\n        return 4 /* RIGHT */;\r\n    if (container.top >= subRect.top)\r\n        return 1 /* ABOVE */;\r\n    if (container.bottom <= subRect.bottom)\r\n        return 2 /* BELOW */;\r\n    return 0 /* CONTAINED */;\r\n}\r\n/**\r\n * a much better polyfill for scrollIntoViewIfNeeded\r\n */\r\nexport function scrollIntoViewIfNeeded(node) {\r\n    if ('scrollIntoViewIfNeeded' in node) { // Chrome only stuff\r\n        node.scrollIntoViewIfNeeded(false);\r\n        return;\r\n    }\r\n    var body = node.ownerDocument.body;\r\n    var window = body.ownerDocument.defaultView;\r\n    var scrollArg = void 0;\r\n    var nodeRect = node.getBoundingClientRect();\r\n    while (scrollArg === void 0) {\r\n        var container = node.parentElement;\r\n        var containerRect = (node === body) ? getViewport(window) : container.getBoundingClientRect();\r\n        var rectRelation = rectContains(containerRect, nodeRect);\r\n        if (rectRelation === 3 /* LEFT */ || rectRelation === 1 /* ABOVE */)\r\n            scrollArg = true;\r\n        if (rectRelation === 4 /* RIGHT */ || rectRelation === 2 /* BELOW */)\r\n            scrollArg = false;\r\n        if (node === body)\r\n            break;\r\n        node = container;\r\n        nodeRect = containerRect;\r\n    }\r\n    if (scrollArg !== void 0)\r\n        node.scrollIntoView(scrollArg);\r\n}\r\n","import { getLineContainer, replace, setCaret, makeBr, getContextDocument } from \"../../dom\";\r\nexport default function createBlockTransformer(prefix, transformLine) {\r\n    return function (caret) {\r\n        var matchResult = caret.textContent.match(prefix);\r\n        if (!matchResult)\r\n            return 0 /* FAILED */;\r\n        var line = getLineContainer(caret);\r\n        var tmpNode = caret;\r\n        while (tmpNode != line) {\r\n            if (tmpNode.previousSibling)\r\n                return 0 /* FAILED */;\r\n            tmpNode = tmpNode.parentNode;\r\n        }\r\n        var document = getContextDocument();\r\n        var placeHolder = document.createComment(\"placeholder\");\r\n        line.parentNode.insertBefore(placeHolder, line);\r\n        var newLine = transformLine(matchResult, line, caret);\r\n        if (!newLine) {\r\n            return 0 /* FAILED */;\r\n        }\r\n        else if (newLine === line) {\r\n            placeHolder.parentNode.removeChild(placeHolder);\r\n        }\r\n        else {\r\n            try {\r\n                placeHolder.parentNode.removeChild(line);\r\n            }\r\n            catch (err) { }\r\n            replace(placeHolder, newLine);\r\n        }\r\n        caret.textContent = \"\";\r\n        if (!newLine.textContent && !newLine.querySelector('br')) {\r\n            var br = makeBr();\r\n            if (caret.nodeType === Node.TEXT_NODE)\r\n                caret.parentNode.insertBefore(br, caret.nextSibling);\r\n            else\r\n                caret.appendChild(br);\r\n        }\r\n        setCaret(caret);\r\n        return 2 /* NEED_PREVENT_DEFAULT */;\r\n    };\r\n}\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformHR = createBlockTransformer(/^---+$/, function (match, line) {\r\n    var hr = elt('hr');\r\n    line.parentNode.insertBefore(hr, line);\r\n    return line;\r\n});\r\nexport default transformHR;\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformHeader = createBlockTransformer(/^#{1,6}$/, function (match, line) {\r\n    var headerLevel = match[0].length;\r\n    var headerEl = elt(\"h\" + headerLevel, null, line.childNodes);\r\n    return headerEl;\r\n});\r\nexport default transformHeader;\r\n","import { elt, makeLine } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformBlockquote = createBlockTransformer(/^(?:>\\s*)+$/, function (match, line) {\r\n    var bqCount = 0, txt = match[0];\r\n    for (var i = 0; i < txt.length; i++)\r\n        if (txt.charAt(i) === '>')\r\n            bqCount++;\r\n    var isInList = line.tagName.toLowerCase() === \"li\";\r\n    if (isInList)\r\n        line = makeLine(line.childNodes);\r\n    var ans = line;\r\n    while (bqCount--)\r\n        ans = elt(\"blockquote\", null, [ans]);\r\n    if (isInList)\r\n        ans = elt(\"li\", null, [ans]);\r\n    return ans;\r\n});\r\nexport default transformBlockquote;\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformOrderedList = createBlockTransformer(/^(\\d+)[\\.\\)]$/, function (match, line) {\r\n    var start = match[1]; // start number\r\n    var item = elt(\"li\", null, line.childNodes);\r\n    var list = elt(\"ol\", { start: start }, [item]);\r\n    return list;\r\n});\r\nexport default transformOrderedList;\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformUnorderedList = createBlockTransformer(/^[-*]$/, function (match, line) {\r\n    var item = elt(\"li\", null, line.childNodes);\r\n    var list = elt(\"ul\", null, [item]);\r\n    return list;\r\n});\r\nexport default transformUnorderedList;\r\n","import { elt } from \"../dom\";\r\nimport createBlockTransformer from \"./pattern/block\";\r\nvar transformCodefence = createBlockTransformer(/^```+([\\w-]*)$/, function (match, line) {\r\n    var lang = match[1];\r\n    var ans = elt('pre', null, line.childNodes);\r\n    if (lang)\r\n        ans.setAttribute(\"data-lang\", lang);\r\n    return ans;\r\n});\r\nexport default transformCodefence;\r\n","export function lastIndexOf(nodes, needle, since) {\r\n    var node, ch;\r\n    if (since) {\r\n        if (!since.node)\r\n            return null;\r\n        node = since.node;\r\n        ch = since.ch;\r\n        while (ch < 0) {\r\n            do {\r\n                node = node.previousSibling;\r\n            } while (node && node.nodeType !== Node.TEXT_NODE);\r\n            if (!node)\r\n                return null;\r\n            node = node;\r\n            ch += node.textContent.length;\r\n        }\r\n        ch = node.textContent.lastIndexOf(needle, ch);\r\n        if (ch > -1)\r\n            return { node: node, ch: ch };\r\n        else\r\n            node = node.previousSibling;\r\n    }\r\n    else {\r\n        node = nodes[nodes.length - 1];\r\n    }\r\n    if (!node)\r\n        return null;\r\n    do {\r\n        if (node.nodeType !== Node.TEXT_NODE)\r\n            continue;\r\n        ch = node.textContent.lastIndexOf(needle);\r\n        if (ch > -1)\r\n            return { node: node, ch: ch };\r\n    } while (node = node.previousSibling);\r\n    return null;\r\n}\r\n","import { setCaretAfter, tidy, getContextDocument } from \"../../dom\";\r\nimport { caretIsSafeForInline } from \"../index\";\r\nimport { lastIndexOf } from \"../../dom/textNodeSearch\";\r\n/**\r\n * Create a Transformer for inline elements.\r\n *\r\n * examples: (where `|` is caret, '**' is tag):\r\n *  - `<p> Hello **World**|</p>`\r\n *  - `<p> Hello **Wo <b>rl</b> d**|</p>`\r\n */\r\nexport default function createInlineTransformer(tag, doWrap, reserveTag) {\r\n    var tagLen = tag.length;\r\n    return function (caret) {\r\n        if (!caretIsSafeForInline(caret) || caret.textContent.slice(-tagLen) !== tag) {\r\n            return 0 /* FAILED */;\r\n        }\r\n        // do not accept **space before tailing tag **\r\n        if (caret.textContent.slice(-tagLen - 1, -tagLen) === ' ')\r\n            return 0 /* FAILED */;\r\n        var document = getContextDocument();\r\n        var caretTextLen = caret.textContent.length;\r\n        // find beginning tag\r\n        var beginPos = lastIndexOf(caret.parentNode.childNodes, tag, { node: caret, ch: caretTextLen - tagLen - 1 });\r\n        if (!beginPos)\r\n            return 0 /* FAILED */;\r\n        var endCh = caretTextLen - tagLen;\r\n        if (!reserveTag) {\r\n            // remove the tag\r\n            caret.textContent = caret.textContent.slice(0, -tagLen);\r\n            var bnt = beginPos.node.textContent;\r\n            beginPos.node.textContent = bnt.slice(0, beginPos.ch) + bnt.slice(beginPos.ch + tagLen);\r\n            if (caret === beginPos.node)\r\n                endCh -= tagLen;\r\n        }\r\n        else {\r\n            // move the selected range\r\n            beginPos.ch += tagLen;\r\n        }\r\n        var range = document.createRange();\r\n        range.setStart(beginPos.node, beginPos.ch);\r\n        range.setEnd(caret, endCh);\r\n        var wrapper = doWrap(range);\r\n        if (!wrapper)\r\n            return 0 /* FAILED */;\r\n        setCaretAfter(wrapper);\r\n        tidy(wrapper.parentElement);\r\n        return 1 /* SUCCESS */;\r\n    };\r\n}\r\n","import { findUpward } from \"../dom\";\r\nimport transformHR from \"./hr\";\r\nimport transformHeader from \"./header\";\r\nimport transformBlockquote from \"./blockquote\";\r\nimport transformOrderedList from \"./ordered-list\";\r\nimport transformUnorderedList from \"./unordered-list\";\r\nimport transformCodefence from \"./codefence\";\r\nimport inlineStyleTransformers from \"./inline-collection\";\r\nimport transformLinkAndImage from \"./link-n-image\";\r\nimport transformEmoji from \"./emoji\";\r\nimport transformMath from \"./math\";\r\nvar transformers = [\r\n    transformHeader, transformHR, transformBlockquote,\r\n    transformOrderedList, transformUnorderedList,\r\n    transformCodefence\r\n].concat(inlineStyleTransformers, [\r\n    transformLinkAndImage,\r\n    transformEmoji,\r\n    transformMath,\r\n]);\r\nexport function caretIsSafeForInline(caret) {\r\n    if (caret.nodeType !== Node.TEXT_NODE)\r\n        return false;\r\n    if (findUpward(caret, function (parent) { return /^(?:code|pre)$/i.test(parent.nodeName); }))\r\n        return false;\r\n    return true;\r\n}\r\nexport { transformers };\r\n","import createInlineTransformer from \"./pattern/inline\";\r\nimport { elt } from \"../dom\";\r\nvar makeWrapFn = function (tag) { return function (range) {\r\n    var wrapper = elt(tag);\r\n    range.surroundContents(wrapper);\r\n    return wrapper;\r\n}; };\r\nexport var wrapCode = makeWrapFn(\"code\");\r\nexport var wrapBold = makeWrapFn(\"b\");\r\nexport var wrapItalic = makeWrapFn(\"i\");\r\nexport var wrapDel = makeWrapFn(\"del\");\r\nexport var wrapBoldItalic = function (range) {\r\n    var wrapper = elt(\"b\");\r\n    var wrapperOutside = elt(\"i\");\r\n    range.surroundContents(wrapper);\r\n    range.surroundContents(wrapperOutside);\r\n    return wrapperOutside;\r\n};\r\nvar inlineStyleTransformers = [\r\n    createInlineTransformer(\"`\", wrapCode),\r\n    createInlineTransformer(\"***\", wrapBoldItalic),\r\n    createInlineTransformer(\"___\", wrapBoldItalic),\r\n    // \"bold\" must be in front of \"italic\"\r\n    createInlineTransformer(\"**\", wrapBold),\r\n    createInlineTransformer(\"__\", wrapBold),\r\n    createInlineTransformer(\"*\", wrapItalic),\r\n    createInlineTransformer(\"_\", wrapItalic),\r\n    createInlineTransformer(\"~~\", wrapDel),\r\n];\r\nexport default inlineStyleTransformers;\r\n","import { setCaretAfter, isTextNode, elt, getContextDocument } from \"../dom\";\r\nimport { lastIndexOf } from \"../dom/textNodeSearch\";\r\nfunction transformLinkAndImage(caret) {\r\n    if (!isTextNode(caret))\r\n        return 0 /* FAILED */;\r\n    if (caret.textContent.slice(-1) !== ')')\r\n        return 0 /* FAILED */;\r\n    var document = getContextDocument();\r\n    var lineNodes = caret.parentElement.childNodes;\r\n    var endPos = { node: caret, ch: caret.textContent.length - 1 };\r\n    var middlePos = lastIndexOf(lineNodes, \"](\", endPos);\r\n    if (!middlePos)\r\n        return 0 /* FAILED */;\r\n    var beginPos = lastIndexOf(lineNodes, \"[\", middlePos);\r\n    if (!beginPos)\r\n        return 0 /* FAILED */;\r\n    // we found ( , )[ and ]    and it's time to extract data\r\n    var urlRange = document.createRange();\r\n    urlRange.setStart(middlePos.node, middlePos.ch);\r\n    urlRange.setEnd(endPos.node, endPos.ch + 1);\r\n    var url = urlRange.cloneContents().textContent.slice(2, -1).trim(); // remove \"](\" and \")\", then trim\r\n    if (!url)\r\n        return 0 /* FAILED */;\r\n    var beginNodeText = beginPos.node.textContent;\r\n    var resultElement;\r\n    var isImage = beginNodeText.charAt(beginPos.ch - 1) === '!';\r\n    var textRange = document.createRange();\r\n    textRange.setStart(beginPos.node, beginPos.ch + 1);\r\n    textRange.setEnd(middlePos.node, middlePos.ch);\r\n    if (isImage) {\r\n        var alt = textRange.cloneContents().textContent.trim();\r\n        resultElement = elt(\"img\", { src: url, alt: alt });\r\n        textRange.setStart(beginPos.node, beginPos.ch - 1);\r\n        textRange.setEnd(endPos.node, endPos.ch + 1);\r\n        textRange.deleteContents();\r\n        textRange.insertNode(resultElement);\r\n    }\r\n    else {\r\n        resultElement = elt(\"a\", { href: url });\r\n        var junkRange = document.createRange();\r\n        junkRange.setStart(beginPos.node, beginPos.ch);\r\n        junkRange.setEnd(beginPos.node, beginPos.ch + 1);\r\n        junkRange.deleteContents();\r\n        urlRange.deleteContents();\r\n        textRange.surroundContents(resultElement);\r\n    }\r\n    setCaretAfter(resultElement);\r\n    return 1 /* SUCCESS */;\r\n}\r\nexport default transformLinkAndImage;\r\n","import { setCaretAfter } from \"../dom\";\r\nimport * as EmojiData from \"../extra/emoji-data\";\r\nexport var shortcodeDict = {\r\n    \"smile\": \"ðŸ˜„\",\r\n};\r\nexport var emoticonDict = {\r\n    \":)\": \"ðŸ˜ƒ\",\r\n};\r\nEmojiData.loadShortCodes(shortcodeDict);\r\nEmojiData.loadEmoticons(emoticonDict, shortcodeDict);\r\nfunction transformEmoji(caret) {\r\n    if (caret.nodeType !== Node.TEXT_NODE)\r\n        return 0 /* FAILED */;\r\n    var text = caret.textContent;\r\n    var output = null;\r\n    var removeCharCount = 0;\r\n    for (var emoticon in emoticonDict) {\r\n        if (text.slice(-emoticon.length) === emoticon) {\r\n            output = emoticonDict[emoticon];\r\n            removeCharCount = emoticon.length;\r\n            break;\r\n        }\r\n    }\r\n    if (!output) {\r\n        var mat = text.match(/:([^:]+):$/);\r\n        output = mat && shortcodeDict[mat[1]];\r\n        if (output) {\r\n            removeCharCount = mat[0].length;\r\n        }\r\n    }\r\n    if (!output)\r\n        return 0 /* FAILED */;\r\n    caret.textContent = text.slice(0, -removeCharCount) + output;\r\n    setCaretAfter(caret);\r\n    return 1 /* SUCCESS */;\r\n}\r\nexport default transformEmoji;\r\n","export function loadEmoticons(dest, shortcodeDict) {\r\n    var sc = {\r\n        angry: ['>:(', '>:-('],\r\n        blush: [':\")', ':-\")'],\r\n        broken_heart: ['</3', '<\\\\3'],\r\n        confused: [':/', ':-/', ':\\\\', ':-\\\\'],\r\n        cry: [\":'(\", \":'-(\", ':,(', ':,-('],\r\n        frowning: [':(', ':-('],\r\n        heart: ['<3'],\r\n        two_hearts: ['<3<3'],\r\n        imp: [']:(', ']:-('],\r\n        innocent: ['o:)', 'O:)', 'o:-)', 'O:-)', '0:)', '0:-)'],\r\n        joy: [\":')\", \":'-)\", ':,)', ':,-)', \":'D\", \":'-D\", ':,D', ':,-D'],\r\n        kissing: [':*', ':-*'],\r\n        laughing: ['x-)', 'X-)'],\r\n        neutral: [':|', ':-|'],\r\n        open_mouth: [':o', ':-o', ':O', ':-O'],\r\n        rage: [':@', ':-@'],\r\n        smile: [':D', ':-D'],\r\n        smiley: [':)', ':-)'],\r\n        smiling_imp: [']:)', ']:-)'],\r\n        sob: [\":,'(\", \":,'-(\", ';(', ';-('],\r\n        tongue: [':P', ':-P'],\r\n        sunglasses: ['8-)', 'B-)'],\r\n        sweat: [',:(', ',:-('],\r\n        unamused: [':s', ':-S', ':z', ':-Z', ':$', ':-$'],\r\n        wink: [';)', ';-)']\r\n    };\r\n    var _loop_1 = function (shortcode) {\r\n        var emoji = shortcodeDict[shortcode];\r\n        if (!emoji)\r\n            return \"continue\";\r\n        sc[shortcode].forEach(function (emoticon) { dest[emoticon] = emoji; });\r\n    };\r\n    for (var shortcode in sc) {\r\n        _loop_1(shortcode);\r\n    }\r\n}\r\nexport function loadShortCodes(dest) {\r\n    /** source https://gist.github.com/rxaviers/7360908 */\r\n    var parts = [\r\n        \"smile:ðŸ˜„;laughing:ðŸ˜†;blush:ðŸ˜Š;smiley:ðŸ˜ƒ;relaxed:â˜ºï¸;smirk:ðŸ˜;heart_eyes:ðŸ˜;kissing_heart:ðŸ˜˜;kissing_closed_eyes:ðŸ˜š;flushed:ðŸ˜³;relieved:ðŸ˜Œ;satisfied:ðŸ˜†;grin:ðŸ˜;wink:ðŸ˜‰;stuck_out_tongue_winking_eye:ðŸ˜œ;stuck_out_tongue_closed_eyes:ðŸ˜;grinning:ðŸ˜€;kissing:ðŸ˜—;kissing_smiling_eyes:ðŸ˜™;stuck_out_tongue:ðŸ˜›;sleeping:ðŸ˜´;worried:ðŸ˜Ÿ;frowning:ðŸ˜¦;anguished:ðŸ˜§;open_mouth:ðŸ˜®;grimacing:ðŸ˜¬;confused:ðŸ˜•;hushed:ðŸ˜¯;expressionless:ðŸ˜‘;unamused:ðŸ˜’;sweat_smile:ðŸ˜…;sweat:ðŸ˜“;disappointed_relieved:ðŸ˜¥;weary:ðŸ˜©;pensive:ðŸ˜”;disappointed:ðŸ˜ž;confounded:ðŸ˜–;fearful:ðŸ˜¨;cold_sweat:ðŸ˜°;persevere:ðŸ˜£;cry:ðŸ˜¢;sob:ðŸ˜­;joy:ðŸ˜‚;astonished:ðŸ˜²;scream:ðŸ˜±;tired_face:ðŸ˜«;angry:ðŸ˜ ;rage:ðŸ˜¡;triumph:ðŸ˜¤;sleepy:ðŸ˜ª;yum:ðŸ˜‹;mask:ðŸ˜·;sunglasses:ðŸ˜Ž;dizzy_face:ðŸ˜µ;imp:ðŸ‘¿;smiling_imp:ðŸ˜ˆ;neutral_face:ðŸ˜;no_mouth:ðŸ˜¶;innocent:ðŸ˜‡;alien:ðŸ‘½;yellow_heart:ðŸ’›;blue_heart:ðŸ’™;purple_heart:ðŸ’œ;heart:â¤ï¸;green_heart:ðŸ’š;broken_heart:ðŸ’”;heartbeat:ðŸ’“;heartpulse:ðŸ’—;two_hearts:ðŸ’•;revolving_hearts:ðŸ’ž;cupid:ðŸ’˜;sparkling_heart:ðŸ’–;sparkles:âœ¨;star:â­ï¸;star2:ðŸŒŸ;dizzy:ðŸ’«;boom:ðŸ’¥;collision:ðŸ’¥;anger:ðŸ’¢;exclamation:â—ï¸;question:â“;grey_exclamation:â•;grey_question:â”;zzz:ðŸ’¤;dash:ðŸ’¨;sweat_drops:ðŸ’¦;notes:ðŸŽ¶;musical_note:ðŸŽµ;fire:ðŸ”¥;hankey:ðŸ’©;poop:ðŸ’©;shit:ðŸ’©;\",\r\n        \"+1:ðŸ‘;thumbsup:ðŸ‘;-1:ðŸ‘Ž;thumbsdown:ðŸ‘Ž;ok_hand:ðŸ‘Œ;punch:ðŸ‘Š;facepunch:ðŸ‘Š;fist:âœŠ;v:âœŒï¸;wave:ðŸ‘‹;hand:âœ‹;raised_hand:âœ‹;open_hands:ðŸ‘;point_up:â˜ï¸;point_down:ðŸ‘‡;point_left:ðŸ‘ˆ;point_right:ðŸ‘‰;raised_hands:ðŸ™Œ;pray:ðŸ™;point_up_2:ðŸ‘†;clap:ðŸ‘;muscle:ðŸ’ª;metal:ðŸ¤˜;fu:ðŸ–•;walking:ðŸš¶;runner:ðŸƒ;running:ðŸƒ;couple:ðŸ‘«;family:ðŸ‘ª;two_men_holding_hands:ðŸ‘¬;two_women_holding_hands:ðŸ‘­;dancer:ðŸ’ƒ;dancers:ðŸ‘¯;ok_woman:ðŸ™†;no_good:ðŸ™…;information_desk_person:ðŸ’;raising_hand:ðŸ™‹;bride_with_veil:ðŸ‘°;person_with_pouting_face:ðŸ™Ž;person_frowning:ðŸ™;bow:ðŸ™‡;couplekiss::couplekiss:;couple_with_heart:ðŸ’‘;massage:ðŸ’†;haircut:ðŸ’‡;nail_care:ðŸ’…;boy:ðŸ‘¦;girl:ðŸ‘§;woman:ðŸ‘©;man:ðŸ‘¨;baby:ðŸ‘¶;older_woman:ðŸ‘µ;older_man:ðŸ‘´;person_with_blond_hair:ðŸ‘±;man_with_gua_pi_mao:ðŸ‘²;man_with_turban:ðŸ‘³;construction_worker:ðŸ‘·;cop:ðŸ‘®;angel:ðŸ‘¼;princess:ðŸ‘¸;smiley_cat:ðŸ˜º;smile_cat:ðŸ˜¸;heart_eyes_cat:ðŸ˜»;kissing_cat:ðŸ˜½;smirk_cat:ðŸ˜¼;scream_cat:ðŸ™€;crying_cat_face:ðŸ˜¿;joy_cat:ðŸ˜¹;pouting_cat:ðŸ˜¾;japanese_ogre:ðŸ‘¹;japanese_goblin:ðŸ‘º;see_no_evil:ðŸ™ˆ;hear_no_evil:ðŸ™‰;speak_no_evil:ðŸ™Š;guardsman:ðŸ’‚;skull:ðŸ’€;feet:ðŸ¾;lips:ðŸ‘„;kiss:ðŸ’‹;droplet:ðŸ’§;ear:ðŸ‘‚;eyes:ðŸ‘€;nose:ðŸ‘ƒ;tongue:ðŸ‘…;love_letter:ðŸ’Œ;bust_in_silhouette:ðŸ‘¤;busts_in_silhouette:ðŸ‘¥;speech_balloon:ðŸ’¬;\",\r\n        \"thought_balloon:ðŸ’­;sunny:â˜€ï¸;umbrella:â˜”ï¸;cloud:â˜ï¸;snowflake:â„ï¸;snowman:â›„ï¸;zap:âš¡ï¸;cyclone:ðŸŒ€;foggy:ðŸŒ;ocean:ðŸŒŠ;cat:ðŸ±;dog:ðŸ¶;mouse:ðŸ­;hamster:ðŸ¹;rabbit:ðŸ°;wolf:ðŸº;frog:ðŸ¸;tiger:ðŸ¯;koala:ðŸ¨;bear:ðŸ»;pig:ðŸ·;pig_nose:ðŸ½;cow:ðŸ®;boar:ðŸ—;monkey_face:ðŸµ;monkey:ðŸ’;horse:ðŸ´;racehorse:ðŸŽ;camel:ðŸ«;sheep:ðŸ‘;elephant:ðŸ˜;panda_face:ðŸ¼;snake:ðŸ;bird:ðŸ¦;baby_chick:ðŸ¤;hatched_chick:ðŸ¥;hatching_chick:ðŸ£;chicken:ðŸ”;penguin:ðŸ§;turtle:ðŸ¢;bug:ðŸ›;honeybee:ðŸ;ant:ðŸœ;beetle:ðŸž;snail:ðŸŒ;octopus:ðŸ™;tropical_fish:ðŸ ;fish:ðŸŸ;whale:ðŸ³;whale2:ðŸ‹;dolphin:ðŸ¬;cow2:ðŸ„;ram:ðŸ;rat:ðŸ€;water_buffalo:ðŸƒ;tiger2:ðŸ…;rabbit2:ðŸ‡;dragon:ðŸ‰;goat:ðŸ;rooster:ðŸ“;dog2:ðŸ•;pig2:ðŸ–;mouse2:ðŸ;ox:ðŸ‚;dragon_face:ðŸ²;blowfish:ðŸ¡;crocodile:ðŸŠ;dromedary_camel:ðŸª;leopard:ðŸ†;cat2:ðŸˆ;poodle:ðŸ©;paw_prints:ðŸ¾;bouquet:ðŸ’;cherry_blossom:ðŸŒ¸;tulip:ðŸŒ·;four_leaf_clover:ðŸ€;rose:ðŸŒ¹;sunflower:ðŸŒ»;hibiscus:ðŸŒº;maple_leaf:ðŸ;leaves:ðŸƒ;fallen_leaf:ðŸ‚;herb:ðŸŒ¿;mushroom:ðŸ„;cactus:ðŸŒµ;palm_tree:ðŸŒ´;evergreen_tree:ðŸŒ²;deciduous_tree:ðŸŒ³;chestnut:ðŸŒ°;seedling:ðŸŒ±;blossom:ðŸŒ¼;ear_of_rice:ðŸŒ¾;shell:ðŸš;globe_with_meridians:ðŸŒ;sun_with_face:ðŸŒž;full_moon_with_face:ðŸŒ;new_moon_with_face:ðŸŒš;new_moon:ðŸŒ‘;waxing_crescent_moon:ðŸŒ’;first_quarter_moon:ðŸŒ“;waxing_gibbous_moon:ðŸŒ”;full_moon:ðŸŒ•;waning_gibbous_moon:ðŸŒ–;last_quarter_moon:ðŸŒ—;waning_crescent_moon:ðŸŒ˜;last_quarter_moon_with_face:ðŸŒœ;\",\r\n        \"first_quarter_moon_with_face:ðŸŒ›;moon:ðŸŒ”;earth_africa:ðŸŒ;earth_americas:ðŸŒŽ;earth_asia:ðŸŒ;volcano:ðŸŒ‹;milky_way:ðŸŒŒ;partly_sunny:â›…ï¸;bamboo:ðŸŽ;gift_heart:ðŸ’;dolls:ðŸŽŽ;school_satchel:ðŸŽ’;mortar_board:ðŸŽ“;flags:ðŸŽ;fireworks:ðŸŽ†;sparkler:ðŸŽ‡;wind_chime:ðŸŽ;rice_scene:ðŸŽ‘;jack_o_lantern:ðŸŽƒ;ghost:ðŸ‘»;santa:ðŸŽ…;christmas_tree:ðŸŽ„;gift:ðŸŽ;bell:ðŸ””;no_bell:ðŸ”•;tanabata_tree:ðŸŽ‹;tada:ðŸŽ‰;confetti_ball:ðŸŽŠ;balloon:ðŸŽˆ;crystal_ball:ðŸ”®;cd:ðŸ’¿;dvd:ðŸ“€;floppy_disk:ðŸ’¾;camera:ðŸ“·;video_camera:ðŸ“¹;movie_camera:ðŸŽ¥;computer:ðŸ’»;tv:ðŸ“º;iphone:ðŸ“±;phone:â˜Žï¸;telephone:â˜Žï¸;telephone_receiver:ðŸ“ž;pager:ðŸ“Ÿ;fax:ðŸ“ ;minidisc:ðŸ’½;vhs:ðŸ“¼;sound:ðŸ”‰;speaker:ðŸ”ˆ;mute:ðŸ”‡;loudspeaker:ðŸ“¢;mega:ðŸ“£;hourglass:âŒ›ï¸;hourglass_flowing_sand:â³;alarm_clock:â°;watch:âŒšï¸;radio:ðŸ“»;satellite:ðŸ“¡;loop:âž¿;mag:ðŸ”;mag_right:ðŸ”Ž;unlock:ðŸ”“;lock:ðŸ”’;lock_with_ink_pen:ðŸ”;closed_lock_with_key:ðŸ”;key:ðŸ”‘;bulb:ðŸ’¡;flashlight:ðŸ”¦;high_brightness:ðŸ”†;low_brightness:ðŸ”…;electric_plug:ðŸ”Œ;battery:ðŸ”‹;calling:ðŸ“²;email:âœ‰ï¸;mailbox:ðŸ“«;postbox:ðŸ“®;bath:ðŸ›€;bathtub:ðŸ›;shower:ðŸš¿;toilet:ðŸš½;wrench:ðŸ”§;nut_and_bolt:ðŸ”©;hammer:ðŸ”¨;seat:ðŸ’º;moneybag:ðŸ’°;yen:ðŸ’´;dollar:ðŸ’µ;pound:ðŸ’·;euro:ðŸ’¶;\",\r\n        \"credit_card:ðŸ’³;money_with_wings:ðŸ’¸;e-mail:ðŸ“§;inbox_tray:ðŸ“¥;outbox_tray:ðŸ“¤;envelope:âœ‰ï¸;incoming_envelope:ðŸ“¨;postal_horn:ðŸ“¯;mailbox_closed:ðŸ“ª;mailbox_with_mail:ðŸ“¬;mailbox_with_no_mail:ðŸ“­;door:ðŸšª;smoking:ðŸš¬;bomb:ðŸ’£;gun:ðŸ”«;hocho:ðŸ”ª;pill:ðŸ’Š;syringe:ðŸ’‰;page_facing_up:ðŸ“„;page_with_curl:ðŸ“ƒ;bookmark_tabs:ðŸ“‘;bar_chart:ðŸ“Š;chart_with_upwards_trend:ðŸ“ˆ;chart_with_downwards_trend:ðŸ“‰;scroll:ðŸ“œ;clipboard:ðŸ“‹;calendar:ðŸ“†;date:ðŸ“…;card_index:ðŸ“‡;file_folder:ðŸ“;open_file_folder:ðŸ“‚;scissors:âœ‚ï¸;pushpin:ðŸ“Œ;paperclip:ðŸ“Ž;black_nib:âœ’ï¸;pencil2:âœï¸;straight_ruler:ðŸ“;triangular_ruler:ðŸ“;closed_book:ðŸ“•;green_book:ðŸ“—;blue_book:ðŸ“˜;orange_book:ðŸ“™;notebook:ðŸ““;notebook_with_decorative_cover:ðŸ“”;ledger:ðŸ“’;books:ðŸ“š;bookmark:ðŸ”–;name_badge:ðŸ“›;microscope:ðŸ”¬;telescope:ðŸ”­;newspaper:ðŸ“°;football:ðŸˆ;basketball:ðŸ€;soccer:âš½ï¸;baseball:âš¾ï¸;tennis:ðŸŽ¾;8ball:ðŸŽ±;\",\r\n        \"rugby_football:ðŸ‰;bowling:ðŸŽ³;golf:â›³ï¸;mountain_bicyclist:ðŸšµ;bicyclist:ðŸš´;horse_racing:ðŸ‡;snowboarder:ðŸ‚;swimmer:ðŸŠ;surfer:ðŸ„;ski:ðŸŽ¿;spades:â™ ï¸;hearts:â™¥ï¸;clubs:â™£ï¸;diamonds:â™¦ï¸;gem:ðŸ’Ž;ring:ðŸ’;trophy:ðŸ†;musical_score:ðŸŽ¼;musical_keyboard:ðŸŽ¹;violin:ðŸŽ»;space_invader:ðŸ‘¾;video_game:ðŸŽ®;black_joker:ðŸƒ;flower_playing_cards:ðŸŽ´;game_die:ðŸŽ²;dart:ðŸŽ¯;mahjong:ðŸ€„ï¸;clapper:ðŸŽ¬;memo:ðŸ“;pencil:ðŸ“;book:ðŸ“–;art:ðŸŽ¨;microphone:ðŸŽ¤;headphones:ðŸŽ§;trumpet:ðŸŽº;saxophone:ðŸŽ·;guitar:ðŸŽ¸;shoe:ðŸ‘ž;sandal:ðŸ‘¡;high_heel:ðŸ‘ ;lipstick:ðŸ’„;boot:ðŸ‘¢;shirt:ðŸ‘•;tshirt:ðŸ‘•;necktie:ðŸ‘”;womans_clothes:ðŸ‘š;dress:ðŸ‘—;running_shirt_with_sash:ðŸŽ½;jeans:ðŸ‘–;kimono:ðŸ‘˜;bikini:ðŸ‘™;ribbon:ðŸŽ€;tophat:ðŸŽ©;crown:ðŸ‘‘;womans_hat:ðŸ‘’;mans_shoe:ðŸ‘ž;closed_umbrella:ðŸŒ‚;briefcase:ðŸ’¼;handbag:ðŸ‘œ;pouch:ðŸ‘;purse:ðŸ‘›;eyeglasses:ðŸ‘“;fishing_pole_and_fish:ðŸŽ£;coffee:â˜•ï¸;tea:ðŸµ;sake:ðŸ¶;baby_bottle:ðŸ¼;beer:ðŸº;beers:ðŸ»;cocktail:ðŸ¸;tropical_drink:ðŸ¹;wine_glass:ðŸ·;fork_and_knife:ðŸ´;pizza:ðŸ•;hamburger:ðŸ”;fries:ðŸŸ;poultry_leg:ðŸ—;meat_on_bone:ðŸ–;spaghetti:ðŸ;curry:ðŸ›;fried_shrimp:ðŸ¤;bento:ðŸ±;sushi:ðŸ£;fish_cake:ðŸ¥;rice_ball:ðŸ™;rice_cracker:ðŸ˜;rice:ðŸš;\",\r\n        \"ramen:ðŸœ;stew:ðŸ²;oden:ðŸ¢;dango:ðŸ¡;egg:ðŸ¥š;bread:ðŸž;doughnut:ðŸ©;custard:ðŸ®;icecream:ðŸ¦;ice_cream:ðŸ¨;shaved_ice:ðŸ§;birthday:ðŸŽ‚;cake:ðŸ°;cookie:ðŸª;chocolate_bar:ðŸ«;candy:ðŸ¬;lollipop:ðŸ­;honey_pot:ðŸ¯;apple:ðŸŽ;green_apple:ðŸ;tangerine:ðŸŠ;lemon:ðŸ‹;cherries:ðŸ’;grapes:ðŸ‡;watermelon:ðŸ‰;strawberry:ðŸ“;peach:ðŸ‘;melon:ðŸˆ;banana:ðŸŒ;pear:ðŸ;pineapple:ðŸ;sweet_potato:ðŸ ;eggplant:ðŸ†;tomato:ðŸ…;corn:ðŸŒ½;house:ðŸ ;house_with_garden:ðŸ¡;school:ðŸ«;office:ðŸ¢;post_office:ðŸ£;hospital:ðŸ¥;bank:ðŸ¦;convenience_store:ðŸª;love_hotel:ðŸ©;hotel:ðŸ¨;wedding:ðŸ’’;church:â›ªï¸;department_store:ðŸ¬;european_post_office:ðŸ¤;city_sunrise:ðŸŒ‡;city_sunset:ðŸŒ†;japanese_castle:ðŸ¯;european_castle:ðŸ°;tent:â›ºï¸;factory:ðŸ­;tokyo_tower:ðŸ—¼;japan:ðŸ—¾;mount_fuji:ðŸ—»;sunrise_over_mountains:ðŸŒ„;sunrise:ðŸŒ…;stars:ðŸŒ ;statue_of_liberty:ðŸ—½;bridge_at_night:ðŸŒ‰;carousel_horse:ðŸŽ ;rainbow:ðŸŒˆ;ferris_wheel:ðŸŽ¡;fountain:â›²ï¸;roller_coaster:ðŸŽ¢;ship:ðŸš¢;speedboat:ðŸš¤;boat:â›µï¸;sailboat:â›µï¸;rowboat:ðŸš£;anchor:âš“ï¸;rocket:ðŸš€;airplane:âœˆï¸;helicopter:ðŸš;steam_locomotive:ðŸš‚;tram:ðŸšŠ;mountain_railway:ðŸšž;bike:ðŸš²;aerial_tramway:ðŸš¡;suspension_railway:ðŸšŸ;\",\r\n        \"mountain_cableway:ðŸš ;tractor:ðŸšœ;blue_car:ðŸš™;oncoming_automobile:ðŸš˜;car:ðŸš—;red_car:ðŸš—;taxi:ðŸš•;oncoming_taxi:ðŸš–;articulated_lorry:ðŸš›;bus:ðŸšŒ;oncoming_bus:ðŸš;rotating_light:ðŸš¨;police_car:ðŸš“;oncoming_police_car:ðŸš”;fire_engine:ðŸš’;ambulance:ðŸš‘;minibus:ðŸš;truck:ðŸšš;train:ðŸš‹;station:ðŸš‰;train2:ðŸš†;bullettrain_front:ðŸš…;bullettrain_side:ðŸš„;light_rail:ðŸšˆ;monorail:ðŸš;railway_car:ðŸšƒ;trolleybus:ðŸšŽ;ticket:ðŸŽ«;fuelpump:â›½ï¸;vertical_traffic_light:ðŸš¦;traffic_light:ðŸš¥;warning:âš ï¸;construction:ðŸš§;beginner:ðŸ”°;atm:ðŸ§;slot_machine:ðŸŽ°;busstop:ðŸš;barber:ðŸ’ˆ;hotsprings:â™¨ï¸;checkered_flag:ðŸ;crossed_flags:ðŸŽŒ;izakaya_lantern:ðŸ®;moyai:ðŸ—¿;circus_tent:ðŸŽª;performing_arts:ðŸŽ­;round_pushpin:ðŸ“;triangular_flag_on_post:ðŸš©;jp:ðŸ‡¯ðŸ‡µ;kr:ðŸ‡°ðŸ‡·;cn:ðŸ‡¨ðŸ‡³;us:ðŸ‡ºðŸ‡¸;fr:ðŸ‡«ðŸ‡·;es:ðŸ‡ªðŸ‡¸;it:ðŸ‡®ðŸ‡¹;ru:ðŸ‡·ðŸ‡º;gb:ðŸ‡¬ðŸ‡§;uk:ðŸ‡¬ðŸ‡§;de:ðŸ‡©ðŸ‡ª;one:1ï¸âƒ£;two:2ï¸âƒ£;three:3ï¸âƒ£;four:4ï¸âƒ£;five:5ï¸âƒ£;six:6ï¸âƒ£;seven:7ï¸âƒ£;eight:8ï¸âƒ£;nine:9ï¸âƒ£;keycap_ten:ðŸ”Ÿ;\",\r\n        \"1234:ðŸ”¢;zero:0ï¸âƒ£;hash:#ï¸âƒ£;symbols:ðŸ”£;arrow_backward:â—€ï¸;arrow_down:â¬‡ï¸;arrow_forward:â–¶ï¸;arrow_left:â¬…ï¸;capital_abcd:ðŸ” ;abcd:ðŸ”¡;abc:ðŸ”¤;arrow_lower_left:â†™ï¸;arrow_lower_right:â†˜ï¸;arrow_right:âž¡ï¸;arrow_up:â¬†ï¸;arrow_upper_left:â†–ï¸;arrow_upper_right:â†—ï¸;arrow_double_down:â¬;arrow_double_up:â«;arrow_down_small:ðŸ”½;arrow_heading_down:â¤µï¸;arrow_heading_up:â¤´ï¸;leftwards_arrow_with_hook:â†©ï¸;arrow_right_hook:â†ªï¸;left_right_arrow:â†”ï¸;arrow_up_down:â†•ï¸;arrow_up_small:ðŸ”¼;arrows_clockwise:ðŸ”ƒ;arrows_counterclockwise:ðŸ”„;rewind:âª;fast_forward:â©;information_source:â„¹ï¸;ok:ðŸ†—;twisted_rightwards_arrows:ðŸ”€;repeat:ðŸ”;repeat_one:ðŸ”‚;new:ðŸ†•;top:ðŸ”;up:ðŸ†™;cool:ðŸ†’;free:ðŸ†“;ng:ðŸ†–;cinema:ðŸŽ¦;koko:ðŸˆ;signal_strength:ðŸ“¶;u5272:ðŸˆ¹;u5408:ðŸˆ´;u55b6:ðŸˆº;u6307:ðŸˆ¯ï¸;u6708:ðŸˆ·ï¸;u6709:ðŸˆ¶;u6e80:ðŸˆµ;u7121:ðŸˆšï¸;u7533:ðŸˆ¸;u7a7a:ðŸˆ³;u7981:ðŸˆ²;sa:ðŸˆ‚ï¸;restroom:ðŸš»;mens:ðŸš¹;womens:ðŸšº;baby_symbol:ðŸš¼;no_smoking:ðŸš­;\",\r\n        \"parking:ðŸ…¿ï¸;wheelchair:â™¿ï¸;metro:ðŸš‡;baggage_claim:ðŸ›„;accept:ðŸ‰‘;wc:ðŸš¾;potable_water:ðŸš°;put_litter_in_its_place:ðŸš®;secret:ãŠ™ï¸;congratulations:ãŠ—ï¸;m:â“‚ï¸;passport_control:ðŸ›‚;left_luggage:ðŸ›…;customs:ðŸ›ƒ;ideograph_advantage:ðŸ‰;cl:ðŸ†‘;sos:ðŸ†˜;id:ðŸ†”;no_entry_sign:ðŸš«;underage:ðŸ”ž;no_mobile_phones:ðŸ“µ;do_not_litter:ðŸš¯;non-potable_water:ðŸš±;no_bicycles:ðŸš³;no_pedestrians:ðŸš·;children_crossing:ðŸš¸;no_entry:â›”ï¸;eight_spoked_asterisk:âœ³ï¸;eight_pointed_black_star:âœ´ï¸;heart_decoration:ðŸ’Ÿ;vs:ðŸ†š;vibration_mode:ðŸ“³;mobile_phone_off:ðŸ“´;chart:ðŸ’¹;currency_exchange:ðŸ’±;aries:â™ˆï¸;taurus:â™‰ï¸;gemini:â™Šï¸;cancer:â™‹ï¸;leo:â™Œï¸;virgo:â™ï¸;libra:â™Žï¸;scorpius:â™ï¸;\",\r\n        \"sagittarius:â™ï¸;capricorn:â™‘ï¸;aquarius:â™’ï¸;pisces:â™“ï¸;ophiuchus:â›Ž;six_pointed_star:ðŸ”¯;negative_squared_cross_mark:âŽ;a:ðŸ…°ï¸;b:ðŸ…±ï¸;ab:ðŸ†Ž;o2:ðŸ…¾ï¸;diamond_shape_with_a_dot_inside:ðŸ’ ;recycle:â™»ï¸;end:ðŸ”š;on:ðŸ”›;soon:ðŸ”œ;clock1:ðŸ•;clock130:ðŸ•œ;clock10:ðŸ•™;clock1030:ðŸ•¥;clock11:ðŸ•š;clock1130:ðŸ•¦;clock12:ðŸ•›;clock1230:ðŸ•§;clock2:ðŸ•‘;clock230:ðŸ•;clock3:ðŸ•’;clock330:ðŸ•ž;clock4:ðŸ•“;clock430:ðŸ•Ÿ;clock5:ðŸ•”;clock530:ðŸ• ;clock6:ðŸ••;clock630:ðŸ•¡;clock7:ðŸ•–;clock730:ðŸ•¢;clock8:ðŸ•—;clock830:ðŸ•£;clock9:ðŸ•˜;clock930:ðŸ•¤;heavy_dollar_sign:ðŸ’²;copyright:Â©ï¸;registered:Â®ï¸;tm:â„¢ï¸;x:âŒ;heavy_exclamation_mark:â—ï¸;bangbang:â€¼ï¸;interrobang:â‰ï¸;o:â­•ï¸;heavy_multiplication_x:âœ–ï¸;\",\r\n        \"heavy_plus_sign:âž•;heavy_minus_sign:âž–;heavy_division_sign:âž—;white_flower:ðŸ’®;100:ðŸ’¯;heavy_check_mark:âœ”ï¸;ballot_box_with_check:â˜‘ï¸;radio_button:ðŸ”˜;link:ðŸ”—;curly_loop:âž°;wavy_dash:ã€°ï¸;part_alternation_mark:ã€½ï¸;trident:ðŸ”±;black_square::black_square:;white_square::white_square:;white_check_mark:âœ…;black_square_button:ðŸ”²;white_square_button:ðŸ”³;black_circle:âš«ï¸;white_circle:âšªï¸;red_circle:ðŸ”´;large_blue_circle:ðŸ”µ;large_blue_diamond:ðŸ”·;large_orange_diamond:ðŸ”¶;small_blue_diamond:ðŸ”¹;small_orange_diamond:ðŸ”¸;small_red_triangle:ðŸ”º;small_red_triangle_down:ðŸ”»\",\r\n    ];\r\n    var matRE = /([^:]+):([^;]+);/g;\r\n    var t;\r\n    for (var i = 0; i < parts.length; i++) {\r\n        matRE.lastIndex = 0;\r\n        while (t = matRE.exec(parts[i])) {\r\n            dest[t[1]] = t[2];\r\n        }\r\n    }\r\n}\r\n","import { elt, setCaretAfter, insertAfter } from \"../dom\";\r\nvar renderer = defaultRenderer;\r\nexport function getMathRenderer() { return renderer; }\r\nexport function setMathRenderer(r) { renderer = r || defaultRenderer; }\r\nfunction defaultRenderer(formula, displayMode) {\r\n    var src = 'http://latex.codecogs.com/gif.latex?' + encodeURIComponent(formula);\r\n    var img = elt('img', {\r\n        src: src,\r\n        alt: formula,\r\n        title: formula,\r\n        'data-formula': formula,\r\n    });\r\n    return img;\r\n}\r\nfunction transformMath(caret) {\r\n    if (caret.nodeType !== Node.TEXT_NODE)\r\n        return 0 /* FAILED */;\r\n    var text = caret.textContent;\r\n    var mat = text.match(/(\\${1,2})([^\\$]+)\\1$/);\r\n    if (!mat)\r\n        return 0 /* FAILED */;\r\n    var expr = mat[2], displayMode = mat[1].length == 2;\r\n    var mathEl = renderer(expr, displayMode);\r\n    if (!mathEl)\r\n        return 0 /* FAILED */;\r\n    caret.textContent = text.slice(0, -mat[0].length);\r\n    insertAfter(mathEl, caret);\r\n    setCaretAfter(mathEl);\r\n    return 1 /* SUCCESS */;\r\n}\r\nexport default transformMath;\r\n","import { wrapCode } from \"../transformer/inline-collection\";\r\nimport { findUpward, breakElement, setCaretAfter, getContextDocument } from \"../dom\";\r\nimport { handleKeyboardEvent } from \"./table-keys\";\r\nfunction handleFormattingKeys(ev) {\r\n    var ctrl = ev.ctrlKey, shift = ev.shiftKey, alt = ev.altKey, which = ev.which;\r\n    var document = getContextDocument();\r\n    if (false) { }\r\n    else if (ctrl && !shift && !alt && which == 73) /* Ctrl+I */\r\n        document.execCommand(\"italic\");\r\n    else if (ctrl && !shift && !alt && which == 66) /* Ctrl+B */\r\n        document.execCommand(\"bold\");\r\n    else if (ctrl && !shift && !alt && which == 85) /* Ctrl+U */\r\n        document.execCommand(\"underline\");\r\n    else if (ctrl && shift && !alt && which == 61) /* Ctrl+Shift+= */\r\n        document.execCommand(\"superscript\");\r\n    else if (ctrl && !shift && !alt && which == 61) /* Ctrl+= */\r\n        document.execCommand(\"subscript\");\r\n    else if (ctrl && !shift && !alt && which == 76) /* Ctrl+L */\r\n        document.execCommand(\"justifyLeft\");\r\n    else if (ctrl && !shift && !alt && which == 69) /* Ctrl+E */\r\n        document.execCommand(\"justifyCenter\");\r\n    else if (ctrl && !shift && !alt && which == 82) /* Ctrl+R */\r\n        document.execCommand(\"justifyRight\");\r\n    else\r\n        return false;\r\n    return true;\r\n}\r\nfunction toggleInlineElement(ev) {\r\n    var ctrl = ev.ctrlKey, shift = ev.shiftKey, alt = ev.altKey, which = ev.which;\r\n    if (ctrl || shift || alt)\r\n        return false;\r\n    var document = getContextDocument();\r\n    var sel = document.getSelection();\r\n    if (sel.isCollapsed)\r\n        return false;\r\n    var caret = sel.focusNode;\r\n    if (caret.nodeType === Node.ELEMENT_NODE)\r\n        caret = caret.childNodes[sel.focusOffset] || caret;\r\n    var range = sel.getRangeAt(0);\r\n    if (which === 192) /* ` */ {\r\n        var code = findUpward(caret, function (el) { return el.nodeName.toLowerCase() === 'code'; });\r\n        if (code) {\r\n            var newCaretAfter = code.lastChild;\r\n            breakElement(code);\r\n            setCaretAfter(newCaretAfter);\r\n        }\r\n        else {\r\n            code = wrapCode(range);\r\n            setCaretAfter(code);\r\n        }\r\n    }\r\n    else\r\n        return false;\r\n    return true;\r\n}\r\nexport default function bindShortkeys(editor) {\r\n    editor.addEventListener('keydown', function (ev) {\r\n        try {\r\n            var handled = false /* add a `false` to align the following methods */\r\n                || handleFormattingKeys(ev)\r\n                || toggleInlineElement(ev)\r\n                || handleKeyboardEvent(ev); // table keys\r\n            if (!handled)\r\n                return;\r\n        }\r\n        catch (err) {\r\n            return;\r\n        }\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n    }, false);\r\n}\r\n","import { findUpward, setCaret, makeLine, replace, insertAfter, elt, makeBr, getContextDocument } from \"../dom\";\r\n/**\r\n * Handle keyboard events for table. Now supports:\r\n *\r\n * - Insert: insert a column\r\n * - Tab: goto next cell, or insert a row\r\n * - Backspace: delete empty row\r\n * - Del: delete empty row\r\n * - Up/Down/Left/Right: navigate between cells\r\n *\r\n * @returns {boolean} handled or not\r\n */\r\nexport function handleKeyboardEvent(ev) {\r\n    var keyCode = ev.keyCode || ev.which;\r\n    var noAdditionalKeys = !(ev.shiftKey || ev.ctrlKey || ev.altKey);\r\n    if ((keyCode !== 8) && //BACKSPACE\r\n        (keyCode !== 45) && //INSERT\r\n        (keyCode !== 46) && //DELETE\r\n        (keyCode !== 9) && //TAB\r\n        (keyCode !== 13) && //ENTER\r\n        (keyCode < 37 || keyCode > 40))\r\n        return false;\r\n    var selection = getContextDocument().getSelection();\r\n    if (!selection.isCollapsed)\r\n        return false;\r\n    var td = findUpward(selection.focusNode, function (el) { return /^t[dh]$/i.test(el.nodeName); });\r\n    var tr = findUpward(td, function (el) { return /^tr$/i.test(el.nodeName); });\r\n    var table = findUpward(tr, function (el) { return /^table$/i.test(el.nodeName); });\r\n    if (!td || !tr || !table)\r\n        return false;\r\n    var td_index = 0; // the index of current td\r\n    var td_count = tr.childElementCount;\r\n    while (td_index < td_count && tr.children[td_index] !== td)\r\n        td_index++;\r\n    if (td_index >= td_count)\r\n        return false; // not found the cell. awkward but shall not happen\r\n    var focus = null;\r\n    function removeRow() {\r\n        if (noAdditionalKeys && !tr.textContent.trim()) {\r\n            focus = tr.nextElementSibling || table.nextElementSibling;\r\n            if (!focus)\r\n                insertAfter(focus = makeLine(), table);\r\n            else if (focus.firstElementChild)\r\n                focus = focus.firstElementChild;\r\n            tr.parentElement.removeChild(tr);\r\n        }\r\n    }\r\n    function removeWholeTable() {\r\n        focus = table.nextElementSibling;\r\n        if (!focus)\r\n            replace(table, focus = makeLine());\r\n        else\r\n            table.parentElement.removeChild(table);\r\n    }\r\n    function removeColumn() {\r\n        var trs = table.querySelectorAll('tr');\r\n        for (var i = 0; i < trs.length; i++) {\r\n            var tr_1 = trs[i];\r\n            var refTd = tr_1.children[td_index];\r\n            tr_1.removeChild(refTd);\r\n        }\r\n    }\r\n    function insertColumn() {\r\n        if (!ev.shiftKey)\r\n            td_index++; //insert column after the current\r\n        var trs = table.querySelectorAll('tr');\r\n        for (var i = 0; i < trs.length; i++) {\r\n            var tr_2 = trs[i];\r\n            var refTd = tr_2.children[td_index];\r\n            var newTd = elt(refTd.nodeName, null, [makeBr()]);\r\n            tr_2.insertBefore(newTd, refTd);\r\n        }\r\n        focus = tr.children[td_index];\r\n    }\r\n    function insertRow(focusCell) {\r\n        var newTr = elt('tr');\r\n        for (var i = 0; i < tr.childNodes.length; i++)\r\n            newTr.appendChild(elt('td'));\r\n        focus = newTr.children[focusCell || 0] || newTr.firstElementChild; // first new cell\r\n        focus.appendChild(makeBr());\r\n        insertAfter(newTr, tr);\r\n    }\r\n    switch (keyCode) {\r\n        case 13: //ENTER: maybe end a table\r\n            if (noAdditionalKeys) {\r\n                if (\"\" === tr.textContent.trim())\r\n                    removeRow();\r\n                else\r\n                    insertRow(td_index);\r\n            }\r\n            break;\r\n        case 46: //DELETE\r\n        case 8: //BACKSPACE\r\n            if (noAdditionalKeys && td.nodeName === \"TH\" && !td.textContent.trim()) {\r\n                // Caret is in the heading row, an empty column.\r\n                focus = (keyCode === 46 && td.nextElementSibling) || td.previousElementSibling;\r\n                if (!focus)\r\n                    removeWholeTable(); // No more column! the whole table is deleted.\r\n                else\r\n                    removeColumn(); // Remove a column\r\n            }\r\n            else {\r\n                removeRow();\r\n            }\r\n            break;\r\n        case 45: //INSERT\r\n            insertColumn();\r\n            break;\r\n        case 9: //TAB\r\n            if (noAdditionalKeys) {\r\n                focus = td.nextElementSibling ||\r\n                    (tr.nextElementSibling && tr.nextElementSibling.firstElementChild);\r\n                if (!focus)\r\n                    insertRow(); // create a row?\r\n            }\r\n            else if (ev.shiftKey) {\r\n                focus = td.previousElementSibling ||\r\n                    (tr.previousElementSibling && tr.previousElementSibling.lastElementChild) ||\r\n                    table.previousElementSibling;\r\n            }\r\n            break;\r\n        case 38: //UP\r\n            if (noAdditionalKeys) {\r\n                focus = (tr.previousElementSibling && tr.previousElementSibling.children[td_index]) ||\r\n                    table.previousElementSibling;\r\n            }\r\n            break;\r\n        case 40: //DOWN\r\n            if (noAdditionalKeys) {\r\n                focus = (tr.nextElementSibling && tr.nextElementSibling.children[td_index]) ||\r\n                    table.nextElementSibling;\r\n            }\r\n            break;\r\n    }\r\n    if (focus) {\r\n        setCaret(focus);\r\n        ev.preventDefault();\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n","import { setCaret, replace, insertAfter, makeBr, makeLine } from \"../dom\";\r\n/**\r\n * Move line to higher level wrapper\r\n *\r\n * - NewWrapper\r\n *   - OldWrapper\r\n *     - Line\r\n *\r\n * eg: From\r\n *\r\n * - #editor\r\n *   - blockquote\r\n *      - p {caret here}\r\n *\r\n * To\r\n *\r\n * - #editor\r\n *   - blockquote\r\n *   - p {caret here}\r\n */\r\nfunction tryHoistBlock(caret, line) {\r\n    // maybe leave a codefence?\r\n    if (line.nodeName.toLowerCase() === 'pre') {\r\n        var pre = line, mat = caret.textContent.match(/(^|[\\r\\n])```+$/);\r\n        if (mat) {\r\n            caret.textContent = caret.textContent.slice(0, -mat[0].length);\r\n            if (caret.nextSibling && caret.nextSibling.nodeName.toLowerCase() === 'br') {\r\n                caret.parentNode.removeChild(caret.nextSibling);\r\n            }\r\n            if (caret.previousSibling && caret.previousSibling.nodeName.toLowerCase() === 'br') {\r\n                caret.parentNode.removeChild(caret.previousSibling);\r\n            }\r\n            var br_1 = makeBr();\r\n            var newLine = makeLine();\r\n            insertAfter(newLine, pre);\r\n            setCaret(newLine);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    // if line is not empty, do not try hoisting it\r\n    if (line.textContent || line.querySelector('img,video,audio,object'))\r\n        return false;\r\n    var oldWrapper = line.parentNode;\r\n    if (!/^(?:ul|ol|blockquote)$/i.test(oldWrapper.nodeName))\r\n        return false;\r\n    var newWrapper = oldWrapper.parentNode;\r\n    newWrapper.insertBefore(line, oldWrapper.nextSibling);\r\n    if (oldWrapper.childNodes.length == 0)\r\n        newWrapper.removeChild(oldWrapper);\r\n    if (!/^(?:ul|ol)$/i.test(newWrapper.nodeName) && line.nodeName.toLowerCase() === 'li') {\r\n        // leaving a list ? convert <li> to <p>\r\n        var newLine = makeLine(line.childNodes);\r\n        replace(line, newLine);\r\n        line = newLine;\r\n    }\r\n    // create a bogus <br>\r\n    var br = line.querySelector('br');\r\n    if (!br) {\r\n        br = makeBr();\r\n        caret.appendChild(br);\r\n    }\r\n    setCaret(br.parentNode);\r\n    return true;\r\n}\r\nexport default tryHoistBlock;\r\n","export var ToastStatus;\r\n(function (ToastStatus) {\r\n    ToastStatus[ToastStatus[\"Hidden\"] = 0] = \"Hidden\";\r\n    ToastStatus[ToastStatus[\"Shown\"] = 1] = \"Shown\";\r\n    ToastStatus[ToastStatus[\"Hiding\"] = 2] = \"Hiding\";\r\n})(ToastStatus || (ToastStatus = {}));\r\n;\r\n/**\r\n * Tooltip Box, or a Toast on Android.\r\n *\r\n * Providing a static method `showToast(text, coveron[, timeout])`, or you can construct one and control its visibility.\r\n */\r\nvar Toast = /** @class */ (function () {\r\n    function Toast(document, text) {\r\n        this.status = ToastStatus.Hidden;\r\n        this.document = document;\r\n        var ele = document.createElement(\"div\");\r\n        ele.setAttribute(\"style\", Toast.style);\r\n        ele.textContent = text;\r\n        ele.addEventListener('mousedown', this.dismiss.bind(this), false);\r\n        this.element = ele;\r\n    }\r\n    Toast.prototype.setPosition = function (left, topOrBottom, isBottom) {\r\n        var ele = this.element;\r\n        ele.style.left = left + 'px';\r\n        ele.style.top = isBottom && 'initial' || (topOrBottom + 'px');\r\n        ele.style.bottom = isBottom && (topOrBottom + 'px') || 'initial';\r\n    };\r\n    Toast.prototype.show = function (timeout) {\r\n        var _this = this;\r\n        var ele = this.element;\r\n        var dismiss = this.dismiss.bind(this);\r\n        if (!ele.parentElement)\r\n            this.document.body.appendChild(ele);\r\n        setTimeout(function () {\r\n            _this.status = ToastStatus.Shown;\r\n            ele.style.opacity = '1';\r\n            ele.style.marginTop = '0';\r\n            if (timeout)\r\n                setTimeout(dismiss, timeout);\r\n        }, 10);\r\n    };\r\n    Toast.prototype.dismiss = function () {\r\n        var _this = this;\r\n        if (this.status !== ToastStatus.Shown)\r\n            return;\r\n        this.status = ToastStatus.Hiding;\r\n        var ele = this.element;\r\n        ele.style.opacity = '0';\r\n        ele.style.marginTop = '-10px';\r\n        setTimeout(function () {\r\n            ele.parentNode.removeChild(ele);\r\n            _this.status = ToastStatus.Hidden;\r\n        }, 300);\r\n    };\r\n    /**\r\n     * A Quick way to show a temporary Toast over an Element.\r\n     *\r\n     * @param {string} text     message to be shown\r\n     * @param {Element} ref     the location reference\r\n     * @param {number} timeout  time in ms. 0 = do not dismiss.\r\n     * @param {boolean} cover   true = cover on the ref. false = shown on top of the ref.\r\n     */\r\n    Toast.showToast = function (text, ref, timeout, cover) {\r\n        var document = ref.ownerDocument;\r\n        var rect = ref['getBoundingClientRect'] && ref.getBoundingClientRect() || { left: 0, top: 0 };\r\n        var toast = new Toast(document, text);\r\n        var x = rect.left + document.body.scrollLeft;\r\n        var y = rect.top + document.body.scrollTop;\r\n        toast.setPosition(x, y, !cover);\r\n        toast.show(timeout);\r\n        return toast;\r\n    };\r\n    Toast.SHORT = 1500;\r\n    Toast.LONG = 3500;\r\n    Toast.style = \"\\nposition: absolute;\\nfont-family: sans-serif;\\npadding: 5px 10px;\\nbackground: #e4F68F;\\nfont-size: 10pt;\\nline-height: 1.4em;\\ncolor: #000;\\nz-index: 32760;\\nmargin-top: -10px;\\ntransition: .2s ease;\\nopacity: 0;\\n\";\r\n    return Toast;\r\n}());\r\nexport { Toast };\r\n","/*!\r\n * MarkdownIME by laobubu\r\n * @url https://github.com/laobubu/MarkdownIME\r\n */\r\nimport * as DOM from \"./dom\";\r\nimport { findCaret, setCaret, replace, getLineContainer, findUpward, makeLine, setContextDocument } from \"./dom\";\r\nimport { transformers } from './transformer';\r\nimport bindShortkeys from \"./extra/shortkeys\";\r\nimport tryHoistBlock from \"./extra/leave-block\";\r\nimport tryInsertLine from \"./extra/new-line\";\r\nimport { Toast } from \"./extra/toast\";\r\nimport tryMakeTable from \"./extra/make-table\";\r\nexport { DOM };\r\nexport { getContextDocument, setContextDocument, elt } from \"./dom\";\r\nexport { Toast, ToastStatus } from \"./extra/toast\";\r\nexport { emoticonDict, shortcodeDict as emojiDict } from \"./transformer/emoji\";\r\nexport { getMathRenderer, setMathRenderer } from \"./transformer/math\";\r\n/** Return all content-editable elements inside the window, which could be enhanced by MarkdownIME. */\r\nexport function Scan(window) {\r\n    var document = window.document;\r\n    var candidates = document.querySelectorAll('[contenteditable], [designMode]');\r\n    var editors = [];\r\n    for (var i = 0; i < candidates.length; i++) {\r\n        var candidate = candidates[i];\r\n        var rect = candidate.getBoundingClientRect();\r\n        if (rect.height > 10 && rect.width > 10)\r\n            editors.push(candidate);\r\n    }\r\n    [].forEach.call(document.querySelectorAll('iframe'), function (i) {\r\n        try {\r\n            var result = Scan(i.contentWindow);\r\n            editors.push.apply(editors, result);\r\n        }\r\n        catch (err) {\r\n            //security limit, cannot scan the iframe\r\n        }\r\n    });\r\n    return editors;\r\n}\r\nexport function Enhance(editor, options) {\r\n    if ('length' in editor) {\r\n        var ans = [];\r\n        for (var i = 0; i < editor.length; i++)\r\n            ans.push(EnhanceOne(editor[i], options));\r\n        return ans;\r\n    }\r\n    else {\r\n        return EnhanceOne(editor, options);\r\n    }\r\n}\r\n/** Scan and enhance all editors, then show a notice. */\r\nexport function Bookmarklet(win, options) {\r\n    var opts = { successToast: true };\r\n    if (options) {\r\n        for (var key in options)\r\n            opts[key] = options[key];\r\n    }\r\n    var editableElements = Scan(win || window);\r\n    Enhance(editableElements, opts);\r\n}\r\nfunction EnhanceOne(editor, options) {\r\n    if (!options)\r\n        options = {};\r\n    if (!('noShortkey' in options)) {\r\n        // by default, disable shortkeys in TinyMCE and Quill\r\n        options.noShortkey = editor.id === 'tinymce' || /\\bql-editor\\b/.test(editor.className);\r\n    }\r\n    if (!options.noShortkey)\r\n        bindShortkeys(editor);\r\n    var document = editor.ownerDocument;\r\n    var doTransform = function (enterKey) {\r\n        setContextDocument(document);\r\n        var caretEl = findCaret();\r\n        if (!caretEl)\r\n            return 0 /* FAILED */;\r\n        if (editor === caretEl) {\r\n            caretEl = makeLine();\r\n            editor.appendChild(caretEl);\r\n            setCaret(caretEl);\r\n        }\r\n        else if (caretEl.nodeType === Node.TEXT_NODE && caretEl.parentNode === editor) {\r\n            // make a line container for\r\n            // <div id=\"editor\"> content <b> not </b> wrapped by P or DIV </div>\r\n            var placeholder = document.createComment(\"placeholder\");\r\n            replace(caretEl, placeholder);\r\n            var line = makeLine([caretEl]);\r\n            replace(placeholder, line);\r\n            setCaret(caretEl);\r\n        }\r\n        for (var i = 0; i < transformers.length; i++) {\r\n            var transformer = transformers[i];\r\n            var trResult = transformer(caretEl);\r\n            if (trResult !== 0 /* FAILED */)\r\n                return trResult;\r\n        }\r\n        // no transformer work. Maybe time to handle Enter Key?\r\n        if (enterKey) {\r\n            var isInCodeFence = !!findUpward(caretEl, function (el) { return el.nodeName.toLowerCase() === 'pre'; });\r\n            var line = getLineContainer(caretEl);\r\n            var success = tryHoistBlock(caretEl, line);\r\n            if (!isInCodeFence && !success) {\r\n                success = tryInsertLine(caretEl, line) || tryMakeTable(caretEl, line);\r\n            }\r\n            if (success)\r\n                return 2 /* NEED_PREVENT_DEFAULT */;\r\n        }\r\n        // Everything failed\r\n        return 0 /* FAILED */;\r\n    };\r\n    editor.addEventListener('keypress', function (ev) {\r\n        if (ev.which === 32 || ev.which === 13) { // pressed space key\r\n            var trResult = doTransform(ev.which === 13);\r\n            if (trResult === 2 /* NEED_PREVENT_DEFAULT */)\r\n                ev.preventDefault();\r\n        }\r\n    }, false);\r\n    if (options.successToast)\r\n        Toast.showToast(\"MarkdownIME loaded\", editor, Toast.SHORT, true);\r\n    return { editor: editor, document: document, doTransform: doTransform };\r\n}\r\n","import { insertAfter, setCaretAfter, makeBr } from \"../dom\";\r\nexport default function tryInsertLine(caret, line) {\r\n    var lineNodeName = line.nodeName.toLowerCase();\r\n    if (lineNodeName === 'pre') {\r\n        // Insert new line into <pre> code fence\r\n        // Only Chrome creates another <pre> like <p>, which is not acceptable\r\n        // Other browsers are smart, no need to worry about them.\r\n        if (!/chrome|webkit/i.test(navigator.userAgent))\r\n            return false;\r\n        var cNext = caret.nextSibling;\r\n        if (cNext && cNext.nodeName.toLowerCase() === 'br') {\r\n            insertAfter(makeBr(), cNext);\r\n            setCaretAfter(cNext);\r\n        }\r\n        else {\r\n            var br = makeBr();\r\n            insertAfter(br, caret);\r\n            insertAfter(makeBr(), br);\r\n            setCaretAfter(br);\r\n        }\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n","import { isTextNode, elt, replace, setCaret, makeBr, getContextDocument } from \"../dom\";\r\nexport default function tryMakeTable(caret, line) {\r\n    var nodes = line.childNodes, first = nodes[0], last = nodes[nodes.length - 1];\r\n    // sometime there is an extra <br>, just remove it\r\n    if (last && last.nodeName.toLowerCase() === 'br') {\r\n        line.removeChild(last);\r\n        last = nodes[nodes.length - 1];\r\n    }\r\n    if (!isTextNode(first) || !isTextNode(last))\r\n        return false;\r\n    if (!/^\\s*\\|/.test(first.textContent) || !/\\|\\s*$/.test(last.textContent))\r\n        return false;\r\n    var headerCells = [];\r\n    var currentCell = null;\r\n    function goNextCell() {\r\n        if (currentCell && currentCell.childNodes.length > 0)\r\n            headerCells.push(currentCell);\r\n        currentCell = elt('th');\r\n    }\r\n    goNextCell();\r\n    while (nodes.length > 0) {\r\n        var srcNode = nodes[0];\r\n        if (isTextNode(srcNode)) {\r\n            srcNode.textContent.split(\"|\").forEach(function (text, idx) {\r\n                if (idx > 0)\r\n                    goNextCell();\r\n                if (!/^\\s*$/.test(text))\r\n                    currentCell.appendChild(getContextDocument().createTextNode(text));\r\n            });\r\n            line.removeChild(srcNode);\r\n        }\r\n        else {\r\n            currentCell.appendChild(srcNode);\r\n        }\r\n    }\r\n    goNextCell();\r\n    if (headerCells.length == 0)\r\n        return false;\r\n    var headerRow = elt('tr', null, headerCells);\r\n    var contentRow = elt('tr', null, headerCells.map(function () { return elt('td'); }));\r\n    var table = elt('table', null, [headerRow, contentRow]);\r\n    var contentCell = contentRow.childNodes[0];\r\n    contentCell.appendChild(makeBr());\r\n    replace(line, table);\r\n    setCaret(contentCell);\r\n    return true;\r\n}\r\n"],"sourceRoot":""}